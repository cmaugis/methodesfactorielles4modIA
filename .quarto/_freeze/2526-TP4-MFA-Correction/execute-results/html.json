{
  "hash": "29a1c7fad3d602ab1b2c9765a640bb16",
  "result": {
    "markdown": "---\ntitle: \"TP4 - Multiple Factor Analysis (MFA) - Correction\"\nsubtitle: \"4modIA / 2025-2026\"\nformat:\n  html:\n    toc: true\n    toc-depth : 4\n    toc-location: left\n    number-sections: true\n    css: styles.css\n---\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ggplot2)\nlibrary(reshape2)\nlibrary(FactoMineR)\nlibrary(factoextra)\nlibrary(corrplot)\n```\n:::\n\n\n# Lecture des données\n\nDans ce TP, nous reprenons le jeu de données des vins qui a été utilisé pour illustrer le cours sur l'Analyse Factorielle Multiple (AFM). Le fichier de données est disponible sur la page moodle du cours `AnaDo_JeuDonnees_VinsJury.csv`. \n\nOn commence par lire le fichier de données à l'aide de la fonction `read.table()` en précisant quelques options. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nvins <- read.table(\"../../SlidesCours/Data/AnaDo_JeuDonnees_VinsJury.csv\",\n                  header=TRUE, sep=\";\",dec=\".\", \n                  row.names=1, check.names=FALSE, fileEncoding=\"latin1\")\nvins[,1]<-as.factor(vins[,1])\nhead(vins)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n                      cepage Int.av.agitation Int.ap.agitation Expression\nS Michaud          Sauvignon         7.750000            8.000   7.142857\nS Renaudie         Sauvignon         7.125000            7.625   7.000000\nS Trotignon        Sauvignon         7.125000            7.375   7.142857\nS Buisse Domaine   Sauvignon         5.500000            6.250   5.428571\nS Buisse Cristal   Sauvignon         6.000000            6.500   6.166667\nV Aub Silex          Vouvray         3.857143            4.250   4.428571\n                    O.fruit O.passion O.agrume O.fruit.confit O.vanille\nS Michaud          4.250000 2.4285714 5.714286      0.6666667 0.5000000\nS Renaudie         4.428571 3.1428571 5.250000      0.6666667 0.5000000\nS Trotignon        5.142857 4.0000000 5.250000      1.0000000 0.5000000\nS Buisse Domaine   4.250000 2.4285714 3.571429      1.5000000 0.6666667\nS Buisse Cristal   5.625000 3.1428571 3.500000      3.0000000 1.1428571\nV Aub Silex        3.857143 0.6666667 3.285714      2.8571429 0.8333333\n                    O.boisee   O.champ O.vegetale O.florale O.alcool\nS Michaud          0.3333333 0.3333333   6.500000  6.571429 1.666667\nS Renaudie         0.3333333 0.3333333   6.125000  6.428571 3.400000\nS Trotignon        0.3333333 0.5000000   4.625000  5.142857 2.833333\nS Buisse Domaine   0.5000000 0.3333333   4.571429  5.750000 2.600000\nS Buisse Cristal   0.8571429 0.2857143   4.285714  4.000000 3.142857\nV Aub Silex        1.0000000 1.6666667   4.375000  3.714286 2.428571\n                   Typicite.olf.chenin Int.attaque   Sucree Acide Amere\nS Michaud                     2.333333    6.000000 3.500000 5.875 4.125\nS Renaudie                    1.125000    6.428571 3.285714 6.750 3.750\nS Trotignon                   0.625000    6.571429 3.000000 6.125 4.125\nS Buisse Domaine              2.571429    5.142857 3.875000 5.625 2.500\nS Buisse Cristal              4.142857    5.571429 3.375000 6.625 5.000\nV Aub Silex                   6.000000    5.142857 7.875000 4.375 3.000\n                   Astringence Fraicheur Oxydation  Finesse\nS Michaud             1.428571  6.625000 0.4285714 5.285714\nS Renaudie            2.333333  6.625000 0.2857143 5.142857\nS Trotignon           2.375000  6.875000 0.4285714 5.285714\nS Buisse Domaine      3.000000  6.250000 0.4285714 4.571429\nS Buisse Cristal      3.125000  6.428571 1.0000000 5.571429\nV Aub Silex           2.375000  4.714286 1.8571429 5.571429\n                   Persistance.gustative Persistance.aromatique Int.couleur\nS Michaud                       7.142857               6.714286       5.000\nS Renaudie                      7.166667               6.571429       3.375\nS Trotignon                     6.142857               6.142857       3.000\nS Buisse Domaine                4.857143               5.142857       4.125\nS Buisse Cristal                6.142857               5.142857       3.625\nV Aub Silex                     5.857143               5.571429       4.000\n                   Nuance.couleur Impression.surface O.Av.Intensite_E\nS Michaud                3.857143                2.5         5.361111\nS Renaudie               3.285714                2.6         5.138889\nS Trotignon              2.428571                2.8         5.277778\nS Buisse Domaine         4.285714                3.5         4.444444\nS Buisse Cristal         3.857143                3.8         4.916667\nV Aub Silex              4.000000                3.5         4.361111\n                   O.Ap.Intensite_E O.Alcool_E O.Vegetale_E O.Champignon_E\nS Michaud                  6.384507   4.121799     3.119488       2.722222\nS Renaudie                 5.966049   4.002137     2.916667       2.416667\nS Trotignon                5.972222   3.805556     3.000000       2.916667\nS Buisse Domaine           5.333333   4.333333     3.305556       2.361111\nS Buisse Cristal           5.766838   4.150370     3.194444       3.222222\nV Aub Silex                5.772435   4.623439     3.777778       2.916667\n                   O.Fruitpassion_E O.Typicite_E G.Intensite_E Sucree_E\nS Michaud                  4.916667     5.861111      5.444444 4.861111\nS Renaudie                 6.027778     5.638889      5.444444 4.666667\nS Trotignon                6.111111     5.055556      5.094377 5.055556\nS Buisse Domaine           5.083333     5.916667      4.722222 4.916667\nS Buisse Cristal           3.927557     5.249967      5.472222 4.612545\nV Aub Silex                3.333333     5.222222      5.526474 6.833333\n                    Acide_E  Amere_E Astringent_E G.Alcool_E Equilibre_E\nS Michaud          5.194444 4.027778     3.694444   5.250000    5.194444\nS Renaudie         5.277778 3.527778     3.527778   4.916667    4.750000\nS Trotignon        4.916667 3.583333     3.708656   4.805556    5.222222\nS Buisse Domaine   4.750000 3.750000     3.388889   4.972222    4.750000\nS Buisse Cristal   5.555556 3.555556     3.611111   5.166667    4.590730\nV Aub Silex        4.638889 3.444444     2.750000   4.876872    4.388889\n                   G.Typicite_E O.Av.Intensite_C O.Ap.Intensite_C O.Alcool_C\nS Michaud              5.416667         4.045455         5.200166   4.087040\nS Renaudie             5.500000         5.318182         6.000000   3.492589\nS Trotignon            5.361111         5.590909         6.090909   3.681818\nS Buisse Domaine       5.342321         4.136364         5.000000   4.227273\nS Buisse Cristal       5.187078         5.500000         6.727273   4.363636\nV Aub Silex            5.750000         3.545455         5.045455   4.610850\n                   O.Vegetale_C O.Champignon_C O.Fruitpassion_C O.Typicite_C\nS Michaud              4.636364       4.490000         5.090909     4.488404\nS Renaudie             4.454545       3.909091         6.454545     4.636364\nS Trotignon            4.590909       2.272727         6.954545     4.889068\nS Buisse Domaine       4.454545       3.636364         4.272727     4.727273\nS Buisse Cristal       4.318182       4.590909         4.090909     4.793830\nV Aub Silex            4.227273       4.045455         4.545455     5.227273\n                   G.Intensite_C Sucree_C  Acide_C  Amere_C Astringent_C\nS Michaud               4.500000 4.772727 4.409091 5.136364     4.272727\nS Renaudie              5.181818 5.363636 5.409091 4.318182     4.545455\nS Trotignon             5.045455 4.863636 5.090909 4.727273     5.727273\nS Buisse Domaine        4.318182 5.363636 4.909091 4.545455     4.636364\nS Buisse Cristal        5.727273 4.227273 6.409091 4.818182     3.954545\nV Aub Silex             4.807500 6.681818 4.500000 3.545455     3.727273\n                   G.Alcool_C Equilibre_C G.Typicite_C Juge1 Juge2 Juge3 Juge4\nS Michaud            5.090909    5.189683     5.000000     7   5.5   2.5     1\nS Renaudie           5.045455    5.090909     4.636364     6   5.5   2.5     2\nS Trotignon          4.603636    5.090909     4.772727     3   4.0   3.0     3\nS Buisse Domaine     4.909091    4.181818     4.272727     6   4.0   2.0     1\nS Buisse Cristal     4.772727    4.106768     4.818182     6   5.0   2.5     2\nV Aub Silex          4.363636    5.566567     5.590909     8   5.0   6.0     6\n                   Juge5 Juge6 Juge7 Juge8 Juge9 Juge10 Juge11 Juge12 Juge13\nS Michaud            5.0   3.5   4.5     1     1      1    2.5      5      1\nS Renaudie           3.5   1.0   3.5     2     8      1    2.5      5      1\nS Trotignon          4.5   2.0   4.0     2     6      4    2.0      8      1\nS Buisse Domaine     3.0   3.0   3.5     4     7      2    2.0      4      1\nS Buisse Cristal     4.0   2.5   4.0     1     3      2    2.5      2      1\nV Aub Silex          3.5   4.5   3.5     3    10      6    5.5      9      6\n                   Juge14 Juge15 Juge16 Juge17 Juge18 Juge19 Juge20 Juge21\nS Michaud             4.0    3.0      1    2.0    6.0    5.5    3.5      1\nS Renaudie            5.0    4.0      1    1.5    4.0    4.5    2.5      2\nS Trotignon           5.0    4.5      6    3.0    7.5    5.5    3.5      2\nS Buisse Domaine      6.0    3.0      3    4.0    3.0    2.5    2.5      6\nS Buisse Cristal      7.5    3.0      1    2.0    3.0    2.5    4.0      1\nV Aub Silex           8.0    4.0      6    5.5    6.0    5.5    4.5      2\n                   Juge22 Juge23 Juge24 Juge25 Juge26 Juge27 Juge28 Juge29\nS Michaud             2.5      5    4.5    4.0    3.0    1.5    2.0    1.5\nS Renaudie            3.5      2    1.0    4.0    3.0    2.5    2.5    1.5\nS Trotignon           2.5      4    3.0    5.0    4.5    3.5    2.5    1.5\nS Buisse Domaine      1.5      1    3.0    4.0    3.5    3.0    2.0    2.0\nS Buisse Cristal      1.5      2    3.5    2.0    4.0    4.0    2.0    3.5\nV Aub Silex           4.0      4    4.0    3.5    5.5    3.0    2.5    3.0\n                   Juge30 Juge31 Juge32 Juge33 Juge34 Juge35 Juge36 Juge37\nS Michaud             3.5    2.0    4.5    6.5    2.5      3    3.5      2\nS Renaudie            5.0    2.0    2.0    6.0    2.5      8    1.5      2\nS Trotignon           5.0    2.5    5.5    6.0    4.0      6    4.0      5\nS Buisse Domaine      4.5    3.0    5.0    7.0    4.5      3    4.0      4\nS Buisse Cristal      7.0    2.5    2.5    7.0    2.0      6    4.0      3\nV Aub Silex           8.0    7.5    8.5    9.5    5.0      4    4.0      4\n                   Juge38 Juge39 Juge40 Juge41 Juge42 Juge43 Juge44 Juge45\nS Michaud             7.0    2.5    3.5    5.5      4      6    3.5      1\nS Renaudie            5.5    2.5    2.0    4.0      3      3    5.0      2\nS Trotignon           4.5    4.0    8.5    5.0      3      7    4.0      1\nS Buisse Domaine      3.5    3.0    5.5    5.5      3      8    2.5      4\nS Buisse Cristal      4.0    3.0    2.0    5.0      2      4    4.0      1\nV Aub Silex           4.5    7.5    7.5    8.0      5      7    7.5      7\n                   Juge46 Juge47 Juge48 Juge49 Juge50 Juge51 Juge52 Juge53\nS Michaud               4    4.5    3.5    5.0      6    3.5    4.5    2.5\nS Renaudie              4    2.0    3.0    4.5      6    2.5    3.5    1.0\nS Trotignon             4    3.5    3.5    5.5      5    3.0    4.0    3.0\nS Buisse Domaine        1    5.0    3.0    8.0      5    2.0    3.0    3.0\nS Buisse Cristal        3    2.0    3.5    8.5      4    3.5    3.0    4.0\nV Aub Silex             7    8.5    6.0    7.0      7    1.0    6.5    5.5\n                   Juge54 Juge55 Juge56 Juge57 Juge58 Juge59 Juge60\nS Michaud             6.5    1.0      6    2.0      8    4.5      5\nS Renaudie            6.5    1.0      2    4.0      1    2.0      1\nS Trotignon           7.5    1.5      3    1.0      1    1.0      2\nS Buisse Domaine      4.0    2.5      3    1.5      6    5.0      3\nS Buisse Cristal      7.0    3.0      1    1.0      4    5.5      2\nV Aub Silex           7.0    3.0      7    2.0      4    6.0      6\n```\n:::\n:::\n\n\n# Groupes de variables\n\n**Question :** Pour rappel, le jeu de données est composé de plusieurs groupes de variables\n\n- *cepage* : une variable qualitative indiquant le cépage\n- *Expert* : 27 variables quantitatives de descripteurs sensoriels d'un jury d'experts\n- *Etudiants* : 15 variables quantitatives de descripteurs sensoriels d'un jury d'étudiants (nom finissant par \"_E\")\n- *Consommateurs* : 15 variables quantitatives de descripteurs sensoriels d'un jury de consommateurs (nom finissant par \"_C\")\n- *Appreciation* : note de 60 consommateurs\n\nCréez des jeux de données distincts par groupe et quelques statistiques descriptives pour chaque groupe.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nDataExpert<-...\nDataStudent<-...\nDataConsumer<-...\nAppreciation<-...\ncepage<-...\n```\n:::\n\n\n:::{.callout-note custom-style=\"correction\" appearance=\"simple\" title=\"Correction\"}\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# j'ai mis cepage dans les data pour supplementary\nDataExpert<-vins[,c(1,2:28)]\nDataStudent<-vins[,c(1,29:43)]\nDataConsumer<-vins[,c(1,44:58)]\nAppreciation<-vins[,c(1,59:118)]\ncepage<-vins[,1]\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Groupe Cepage\ntable(cepage)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\ncepage\nSauvignon   Vouvray \n        5         5 \n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Groupe Expert\nggplot(melt(DataExpert[,-1]),aes(x=variable,y=value))+\n  geom_boxplot()+\n  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))\n```\n\n::: {.cell-output-display}\n![](2526-TP4-MFA-Correction_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n\n```{.r .cell-code}\ncorrplot(cor(DataExpert[,-1]),method=\"ellipse\",tl.cex=0.5)\n```\n\n::: {.cell-output-display}\n![](2526-TP4-MFA-Correction_files/figure-html/unnamed-chunk-6-2.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Groupe Student\nggplot(melt(DataStudent[,-1]),aes(x=variable,y=value))+\n  geom_boxplot()+\n  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))\n```\n\n::: {.cell-output-display}\n![](2526-TP4-MFA-Correction_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n\n```{.r .cell-code}\ncorrplot(cor(DataStudent[,-1]),method=\"ellipse\",tl.cex=0.5)\n```\n\n::: {.cell-output-display}\n![](2526-TP4-MFA-Correction_files/figure-html/unnamed-chunk-7-2.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Groupe Consumer\nggplot(melt(DataConsumer[,-1]),aes(x=variable,y=value))+\n  geom_boxplot()+\n  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))\n```\n\n::: {.cell-output-display}\n![](2526-TP4-MFA-Correction_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n\n```{.r .cell-code}\ncorrplot(cor(DataConsumer[,-1]),method=\"ellipse\")\n```\n\n::: {.cell-output-display}\n![](2526-TP4-MFA-Correction_files/figure-html/unnamed-chunk-8-2.png){width=672}\n:::\n:::\n\n\n:::\n\n# ACP pour chaque jury\n\n**Question :** Faites une ACP pour le jeu de données des descripteurs sensoriels pour chaque jury séparément (à l'aide de la fonction `PCA`de la librairie `FactoMineR`). Analysez les résultats. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nACPExpert<-PCA(DataExpert,.....)\nACPStudent<-PCA(DataStudent, ....)\nACPConsumer<-PCA(DataConsumer, ....)\nfviz_eig(....)\nfviz_pca_ind(....)\nfviz_pca_var(.....)\n```\n:::\n\n\n:::{.callout-note custom-style=\"correction\" appearance=\"simple\" title=\"Correction\"}\n\n## ACP sur les experts\n\n::: {.cell}\n\n```{.r .cell-code}\nACPExpert<-PCA(DataExpert,scale.unit = T,quali.sup = 1,graph=F)\nACPExpert$eig\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n       eigenvalue percentage of variance cumulative percentage of variance\ncomp 1 11.7400621             43.4817113                          43.48171\ncomp 2  6.7871125             25.1374537                          68.61917\ncomp 3  2.7407517             10.1509324                          78.77010\ncomp 4  2.0297733              7.5176790                          86.28778\ncomp 5  1.6119469              5.9701737                          92.25795\ncomp 6  0.8395668              3.1095065                          95.36746\ncomp 7  0.6424252              2.3793528                          97.74681\ncomp 8  0.3660944              1.3559053                          99.10271\ncomp 9  0.2422670              0.8972853                         100.00000\n```\n:::\n\n```{.r .cell-code}\nfviz_eig(ACPExpert)\n```\n\n::: {.cell-output-display}\n![](2526-TP4-MFA-Correction_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n\n```{.r .cell-code}\nfviz_pca_ind(ACPExpert,habillage=1,repel=T)\n```\n\n::: {.cell-output-display}\n![](2526-TP4-MFA-Correction_files/figure-html/unnamed-chunk-10-2.png){width=672}\n:::\n\n```{.r .cell-code}\nfviz_pca_var(ACPExpert,repel=T)\n```\n\n::: {.cell-output-display}\n![](2526-TP4-MFA-Correction_files/figure-html/unnamed-chunk-10-3.png){width=672}\n:::\n:::\n\n\n## ACP sur les étudiants\n\n::: {.cell}\n\n```{.r .cell-code}\nACPStudent<-PCA(DataStudent,scale.unit = T,quali.sup = 1,graph=F)\nACPStudent$eig\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n       eigenvalue percentage of variance cumulative percentage of variance\ncomp 1 7.89545068             52.6363379                          52.63634\ncomp 2 3.83919552             25.5946368                          78.23097\ncomp 3 1.70972610             11.3981740                          89.62915\ncomp 4 0.58234129              3.8822753                          93.51142\ncomp 5 0.35447610              2.3631740                          95.87460\ncomp 6 0.32006528              2.1337685                          98.00837\ncomp 7 0.18079198              1.2052799                          99.21365\ncomp 8 0.10205134              0.6803422                          99.89399\ncomp 9 0.01590172              0.1060114                         100.00000\n```\n:::\n\n```{.r .cell-code}\nfviz_eig(ACPStudent)\n```\n\n::: {.cell-output-display}\n![](2526-TP4-MFA-Correction_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n\n```{.r .cell-code}\nfviz_pca_ind(ACPStudent,habillage=1,repel=T)\n```\n\n::: {.cell-output-display}\n![](2526-TP4-MFA-Correction_files/figure-html/unnamed-chunk-11-2.png){width=672}\n:::\n\n```{.r .cell-code}\nfviz_pca_var(ACPStudent,repel=T)\n```\n\n::: {.cell-output-display}\n![](2526-TP4-MFA-Correction_files/figure-html/unnamed-chunk-11-3.png){width=672}\n:::\n:::\n\n\n## ACP sur les consommateurs\n\n::: {.cell}\n\n```{.r .cell-code}\nACPConsumer<-PCA(DataConsumer,scale.unit = T,quali.sup = 1,graph=F)\nACPConsumer$eig\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n       eigenvalue percentage of variance cumulative percentage of variance\ncomp 1 7.17562157             47.8374771                          47.83748\ncomp 2 2.59181264             17.2787510                          65.11623\ncomp 3 1.65346984             11.0231322                          76.13936\ncomp 4 1.44260006              9.6173337                          85.75669\ncomp 5 0.69146720              4.6097813                          90.36648\ncomp 6 0.64755113              4.3170076                          94.68348\ncomp 7 0.49029805              3.2686536                          97.95214\ncomp 8 0.21595859              1.4397239                          99.39186\ncomp 9 0.09122093              0.6081395                         100.00000\n```\n:::\n\n```{.r .cell-code}\nfviz_eig(ACPConsumer)\n```\n\n::: {.cell-output-display}\n![](2526-TP4-MFA-Correction_files/figure-html/unnamed-chunk-12-1.png){width=672}\n:::\n\n```{.r .cell-code}\nfviz_pca_ind(ACPConsumer,habillage=1,repel=T)\n```\n\n::: {.cell-output-display}\n![](2526-TP4-MFA-Correction_files/figure-html/unnamed-chunk-12-2.png){width=672}\n:::\n\n```{.r .cell-code}\nfviz_pca_var(ACPConsumer,repel=T)\n```\n\n::: {.cell-output-display}\n![](2526-TP4-MFA-Correction_files/figure-html/unnamed-chunk-12-3.png){width=672}\n:::\n:::\n\n\n:::\n\n# AFM avec FactoMineR\n\n**Question :** Faites une analyse factorielle multiple (AFM) avec la fonction `MFA()` de la librairie `FactoMineR` sur le jeu de données `vins`. Le cépage et le groupe de variables `Appreciation` sont considérés comme des groupes de variables supplémentaires. Explorez la structure du contenu de la sortie `resMFA`. Retrouvez-vous les ACP faites dans la question précédente ?\n\n\n::: {.cell}\n\n```{.r .cell-code}\nresMFA<-MFA(.....)\nresMFA\n```\n:::\n\n\n:::{.callout-note custom-style=\"correction\" appearance=\"simple\" title=\"Correction\"}\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nresMFA <- MFA(vins, group=c(1,27,15,15,60), type=c(\"n\",rep(\"s\",4)), \n           num.group.sup=c(1,5),\n           name.group=c(\"Grade\",\"Expert\",\"Student\",\"Consumer\",\"Appreciation\"),\n           graph=F)\nresMFA\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n**Results of the Multiple Factor Analysis (MFA)**\nThe analysis was performed on 10 individuals, described by 118 variables\n*Results are available in the following objects :\n\n   name                 description                                           \n1  \"$eig\"               \"eigenvalues\"                                         \n2  \"$separate.analyses\" \"separate analyses for each group of variables\"       \n3  \"$group\"             \"results for all the groups\"                          \n4  \"$partial.axes\"      \"results for the partial axes\"                        \n5  \"$inertia.ratio\"     \"inertia ratio\"                                       \n6  \"$ind\"               \"results for the individuals\"                         \n7  \"$quanti.var\"        \"results for the quantitative variables\"              \n8  \"$quanti.var.sup\"    \"results for the quantitative supplementary variables\"\n9  \"$quali.var.sup\"     \"results for the categorical supplementary variables\" \n10 \"$summary.quanti\"    \"summary for the quantitative variables\"              \n11 \"$summary.quali\"     \"summary for the categorical variables\"               \n12 \"$global.pca\"        \"results for the global PCA\"                          \n```\n:::\n:::\n\n\nOn retrouve les résultats des ACP séparées dans `$separate.analyses$`. Par exemple pour les Experts :\n\n\n::: {.cell}\n\n```{.r .cell-code}\nresMFA$separate.analyses$Expert\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n**Results for the Principal Component Analysis (PCA)**\nThe analysis was performed on 10 individuals, described by 27 variables\n*The results are available in the following objects:\n\n   name               description                          \n1  \"$eig\"             \"eigenvalues\"                        \n2  \"$var\"             \"results for the variables\"          \n3  \"$var$coord\"       \"coord. for the variables\"           \n4  \"$var$cor\"         \"correlations variables - dimensions\"\n5  \"$var$cos2\"        \"cos2 for the variables\"             \n6  \"$var$contrib\"     \"contributions of the variables\"     \n7  \"$ind\"             \"results for the individuals\"        \n8  \"$ind$coord\"       \"coord. for the individuals\"         \n9  \"$ind$cos2\"        \"cos2 for the individuals\"           \n10 \"$ind$contrib\"     \"contributions of the individuals\"   \n11 \"$call\"            \"summary statistics\"                 \n12 \"$call$centre\"     \"mean of the variables\"              \n13 \"$call$ecart.type\" \"standard error of the variables\"    \n14 \"$call$row.w\"      \"weights for the individuals\"        \n15 \"$call$col.w\"      \"weights for the variables\"          \n```\n:::\n:::\n\n:::\n\n# Lien entre AFM et ACP\n\n**Question :** L'analyse factorielle multiple est une ACP sur un jeu de données particulier que l'on appelle `DataMFA`. Retrouvez numériquement ce résultat. \n\n\n::: {.cell}\n\n```{.r .cell-code}\ndExpert<-....\ndStudent<-...\ndConsumer<-...\nDataMFA<-cbind(dexpert,dStudent,dConsumer)\nDataMFA<-data.frame(cepage=cepage,DataMFA)\n\nresglobal<-PCA(DataMFA,....)\n```\n:::\n\n\n\n:::{.callout-note custom-style=\"correction\" appearance=\"simple\" title=\"Correction\"}\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Si on essaie de refaire à la main\nn<-nrow(vins)\ndExpert<-scale(DataExpert[,-1],scale = F)\nfor (j in 1:ncol(dExpert))\n  dExpert[,j]<-dExpert[,j] / (sqrt((n-1)*var(dExpert[,j])/n))\ndExpert<-dExpert/sqrt(ACPExpert$eig[1,1])\n\ndStudent<-scale(DataStudent[,-1],scale = F)\nfor (j in 1:ncol(dStudent))\n  dStudent[,j]<-dStudent[,j] / (sqrt((n-1)*var(dStudent[,j])/n))\ndStudent<-dStudent/sqrt(ACPStudent$eig[1,1])\n\ndConsumer<-scale(DataConsumer[,-1],scale = F)\nfor (j in 1:ncol(dConsumer))\n  dConsumer[,j]<-dConsumer[,j] / (sqrt((n-1)*var(dConsumer[,j])/n))\ndConsumer<-dConsumer/sqrt(ACPConsumer$eig[1,1])\n\nDataMFA<-cbind(dExpert,dStudent,dConsumer)\nDataMFA<-data.frame(cepage=cepage,DataMFA)\n```\n:::\n\n\nLien entre ACP sur DataMFA et ce que fait la fonction MFA\n\n\n::: {.cell}\n\n```{.r .cell-code}\nresglobal<-PCA(DataMFA,quali.sup=1,scale.unit = F,graph=F)\nresglobal$eig\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n       eigenvalue percentage of variance cumulative percentage of variance\ncomp 1 2.67424775              42.515478                          42.51548\ncomp 2 1.53623686              24.423258                          66.93874\ncomp 3 0.57843255               9.195983                          76.13472\ncomp 4 0.44159267               7.020488                          83.15521\ncomp 5 0.31919749               5.074636                          88.22984\ncomp 6 0.27437578               4.362056                          92.59190\ncomp 7 0.23522005               3.739554                          96.33145\ncomp 8 0.13497602               2.145863                          98.47731\ncomp 9 0.09577777               1.522685                         100.00000\n```\n:::\n\n```{.r .cell-code}\nresMFA$eig\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n       eigenvalue percentage of variance cumulative percentage of variance\ncomp 1 2.67424775              42.515478                          42.51548\ncomp 2 1.53623686              24.423258                          66.93874\ncomp 3 0.57843255               9.195983                          76.13472\ncomp 4 0.44159267               7.020488                          83.15521\ncomp 5 0.31919749               5.074636                          88.22984\ncomp 6 0.27437578               4.362056                          92.59190\ncomp 7 0.23522005               3.739554                          96.33145\ncomp 8 0.13497602               2.145863                          98.47731\ncomp 9 0.09577777               1.522685                         100.00000\n```\n:::\n\n```{.r .cell-code}\nresMFA$global.pca$eig\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n       eigenvalue percentage of variance cumulative percentage of variance\ncomp 1 2.67424775              42.515478                          42.51548\ncomp 2 1.53623686              24.423258                          66.93874\ncomp 3 0.57843255               9.195983                          76.13472\ncomp 4 0.44159267               7.020488                          83.15521\ncomp 5 0.31919749               5.074636                          88.22984\ncomp 6 0.27437578               4.362056                          92.59190\ncomp 7 0.23522005               3.739554                          96.33145\ncomp 8 0.13497602               2.145863                          98.47731\ncomp 9 0.09577777               1.522685                         100.00000\n```\n:::\n:::\n\n\nPlot des individus en mettant des couleurs sur cépage. On retrouve le graphe des individus avec ACP global\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfviz_mfa_ind(resMFA,habillage = 1,repel=T)+theme(legend.position=\"none\")\n```\n\n::: {.cell-output-display}\n![](2526-TP4-MFA-Correction_files/figure-html/unnamed-chunk-19-1.png){width=672}\n:::\n\n```{.r .cell-code}\nfviz_pca_ind(resglobal,habillage=1,repel=T)+theme(legend.position=\"none\")\n```\n\n::: {.cell-output-display}\n![](2526-TP4-MFA-Correction_files/figure-html/unnamed-chunk-19-2.png){width=672}\n:::\n:::\n\n\n\nPlot des variables en mettant des couleurs aux groupes. \nOn retrouve celui en ACP global mais on n'a pas l'info des groupes dans ce cas. \n\n\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(resMFA,choix=\"var\",cex=1,invisible=\"quanti.sup\")\n```\n\n::: {.cell-output-display}\n![](2526-TP4-MFA-Correction_files/figure-html/unnamed-chunk-21-1.png){width=672}\n:::\n\n```{.r .cell-code}\nfviz_pca_var(resglobal)\n```\n\n::: {.cell-output-display}\n![](2526-TP4-MFA-Correction_files/figure-html/unnamed-chunk-21-2.png){width=672}\n:::\n:::\n\n\n:::\n\n**Question :** Déterminez les valeurs de $\\mathcal L_g$ entre les groupes de variables. Comparez avec les valeurs dans `resMFA$group$Lg`. Que représentent les termes diagonaux ? Quel est le lien avec les valeurs propres des ACP séparées ? Vérifiez numériquement.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# A COMPLETER\n```\n:::\n\n\n:::{.callout-note custom-style=\"correction\" appearance=\"simple\" title=\"Correction\"}\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nresMFA$group$Lg\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n                 Grade    Expert   Student  Consumer Appreciation       MFA\nGrade        1.0000000 0.8924911 0.6232526 0.2829170    0.3710353 0.6725857\nExpert       0.8924911 1.4469687 1.1693695 0.9426289    1.0088434 1.3308292\nStudent      0.6232526 1.1693695 1.2931296 1.0449315    1.0315249 1.3115579\nConsumer     0.2829170 0.9426289 1.0449315 1.2471444    1.1086861 1.2095756\nAppreciation 0.3710353 1.0088434 1.0315249 1.1086861    1.4684577 1.1775477\nMFA          0.6725857 1.3308292 1.3115579 1.2095756    1.1775477 1.4403911\n```\n:::\n\n```{.r .cell-code}\nCOV<-cov(DataMFA[,-1])*(n-1)/n\nCOV2<-COV^2\n\n#par exemple expert / Student\nsum(COV2[1:27,28:42])\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 1.16937\n```\n:::\n\n```{.r .cell-code}\n# On retrouve la relation avec les valeurs propres de l'ACP séparée\n# exemple Expert Lg(expert,expert)= 1.4469687\nsum((ACPExpert$eig[,1]/ACPExpert$eig[1,1])^2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 1.446969\n```\n:::\n:::\n\n:::\n\n\n**Question :** Comment est construit le graphique donné par la fonction suivante ? Commentez-le.  \n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfviz_mfa_var(resMFA,\"group\",repel=TRUE)\n```\n:::\n\n\n:::{.callout-note custom-style=\"correction\" appearance=\"simple\" title=\"Correction\"}\n\nLes points (correspondant à chaque groupe) ont pour coordonnées $(\\mathcal L_g(j,PC1),\\mathcal L_g(j,PC2)$). \n\n\n::: {.cell}\n\n```{.r .cell-code}\nfviz_mfa_var(resMFA,\"group\",repel=TRUE)\n```\n\n::: {.cell-output-display}\n![](2526-TP4-MFA-Correction_files/figure-html/unnamed-chunk-25-1.png){width=672}\n:::\n:::\n\n:::\n\n\n**Question :** Quel est le lien entre les valeurs de $\\mathcal L_g(j,j')$ et de $RV(j,j')$ ? Vérifiez numériquement et commentez les résultats. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nRV<- ...\nresMFA$group$RV\n```\n:::\n\n\n:::{.callout-note custom-style=\"correction\" appearance=\"simple\" title=\"Correction\"}\n\n\n$$\nRV(j,j') = \\frac{\\mathcal L_g(j,j')}{\\sqrt{\\mathcal L_g(j,j)} \\sqrt{\\mathcal L_g(j',j')}}\n$$\n\n\n::: {.cell}\n\n```{.r .cell-code}\nresMFA$group$RV\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n                 Grade    Expert   Student  Consumer Appreciation       MFA\nGrade        1.0000000 0.7419495 0.5480789 0.2533382    0.3061854 0.5604120\nExpert       0.7419495 1.0000000 0.8548722 0.7017022    0.6920915 0.9218336\nStudent      0.5480789 0.8548722 1.0000000 0.8228268    0.7485624 0.9610062\nConsumer     0.2533382 0.7017022 0.8228268 1.0000000    0.8192558 0.9024734\nAppreciation 0.3061854 0.6920915 0.7485624 0.8192558    1.0000000 0.8096692\nMFA          0.5604120 0.9218336 0.9610062 0.9024734    0.8096692 1.0000000\n```\n:::\n\n```{.r .cell-code}\n# exemple Expert / Student\nresMFA$group$Lg[2,3]/sqrt(resMFA$group$Lg[2,2]*resMFA$group$Lg[3,3])\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.8548722\n```\n:::\n:::\n\n\n:::\n\n**Question :** On s'intéresse maintenant aux points partiels qui sont représentés à l'aide de la commande suivante. Comment ces points sont-ils calculés ? Vérifiez numériquement. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nfviz_mfa_ind(resMFA,partial = \"all\",repel=T)+theme(legend.position=\"bottom\")\n```\n:::\n\n\n:::{.callout-note custom-style=\"correction\" appearance=\"simple\" title=\"Correction\"}\n\n\nOn prend un individu $i$ et le groupe de variable $j$. \nOn prend la ligne de données correspondant à l'individu $i$ et on remplace par zéro les valeurs pour les variables qui ne sont pas du groupe $j$. C'est un individu supplémentaire dont on cherche les données. \n\n$$\nC_s^{(ind)}(i^{[j]}) = J \\frac{1}{\\sqrt{\\lambda_s}} \\frac{1}{\\lambda_1^{(j)}} \\underset{k=1}{\\stackrel{K_j}{\\sum}} X_{ik}^{(j)} C_s^{(var)}(k)\n$$\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfviz_mfa_ind(resMFA,partial = \"all\",repel=T)+theme(legend.position=\"bottom\")\n```\n\n::: {.cell-output-display}\n![](2526-TP4-MFA-Correction_files/figure-html/unnamed-chunk-29-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# Les coordonnees sont dans \nresMFA$ind$coord.partiel[,1:2]\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n                                 Dim.1      Dim.2\nS Michaud  .Expert          -1.5844493  2.2246023\nS Michaud  .Student         -0.8972838  1.2418470\nS Michaud  .Consumer        -1.1008127 -0.3284702\nS Renaudie  .Expert         -1.4276862  2.5516745\nS Renaudie  .Student        -1.3671591  1.2283626\nS Renaudie  .Consumer       -0.9870226  0.6466955\nS Trotignon  .Expert        -1.5230765  2.3530014\nS Trotignon  .Student       -1.7387724  1.4277378\nS Trotignon  .Consumer      -1.1908972  1.1651216\nS Buisse Domaine  .Expert   -1.4330237 -0.4534727\nS Buisse Domaine  .Student  -1.6865047 -0.6404303\nS Buisse Domaine  .Consumer -0.9061216 -0.7214868\nS Buisse Cristal  .Expert   -0.5599879  0.4394385\nS Buisse Cristal  .Student  -0.1479767  0.3533794\nS Buisse Cristal  .Consumer  0.7249844  0.3934586\nV Aub Silex  .Expert        -0.8772968 -3.0199305\nV Aub Silex  .Student       -1.7871353 -2.4647820\nV Aub Silex  .Consumer      -3.1051789 -2.2144115\nV Aub Marigny  .Expert       2.3445286 -0.2583887\nV Aub Marigny  .Student      2.5622916  0.2946038\nV Aub Marigny  .Consumer     2.6708190  0.9634175\nV Font Domaine  .Expert      1.1078865 -1.5433923\nV Font Domaine  .Student     0.8505658 -1.1040112\nV Font Domaine  .Consumer    0.9555462 -0.2266972\nV Font Brûlés  .Expert       1.6726308 -1.6943033\nV Font Brûlés  .Student      0.5817594 -0.6400709\nV Font Brûlés  .Consumer     0.4108975 -0.8756062\nV Font Coteaux  .Expert      2.2804744 -0.5992292\nV Font Coteaux  .Student     3.6302153  0.3033638\nV Font Coteaux  .Consumer    2.5277859  1.1979786\n```\n:::\n\n```{.r .cell-code}\n# pour retrouver pour le premier indiv par exemple\nJ<-3\nlambdas<-resMFA$eig[1,1] #s=1\nlambda1j<-ACPExpert$eig[1,1] # j=1 Expert\nXikj<-DataMFA[1,2:28] # on ne prend que les 27 variables du groupe j=1\nCsj<-resMFA$global.pca$var$coord[1:27,1]\n\nJ*sum(Xikj*Csj) / sqrt(lambdas*lambda1j)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] -1.584449\n```\n:::\n\n```{.r .cell-code}\nresMFA$ind$coord.partiel[1,1]\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] -1.584449\n```\n:::\n:::\n\n:::\n\n**Question :** Que représente la fonction suivante ? Retrouvez le lien avec les composantes principales des différentes ACP. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nfviz_mfa_axes(resMFA,repel=T)\n\n# A COMPLETER\n```\n:::\n\n\n:::{.callout-note custom-style=\"correction\" appearance=\"simple\" title=\"Correction\"}\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfviz_mfa_axes(resMFA,repel=T)\n```\n\n::: {.cell-output-display}\n![](2526-TP4-MFA-Correction_files/figure-html/unnamed-chunk-31-1.png){width=672}\n:::\n\n```{.r .cell-code}\ncor(resMFA$ind$coord[,1:2],resMFA$separate.analyses$Expert$ind$coord[,1])\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n            [,1]\nDim.1  0.7960330\nDim.2 -0.5841472\n```\n:::\n\n```{.r .cell-code}\nresMFA$partial.axes$coord[,1:2]\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n                        Dim.1       Dim.2\nDim1.Grade         0.64516875 -0.63907147\nDim1.Expert        0.79603297 -0.58414721\nDim2.Expert        0.54477129  0.78640706\nDim3.Expert       -0.15932786 -0.14203401\nDim4.Expert        0.11961470  0.12553140\nDim5.Expert        0.01360498  0.04107984\nDim1.Student       0.98331387  0.02182353\nDim2.Student      -0.02443836  0.98621050\nDim3.Student      -0.10414386  0.00310554\nDim4.Student      -0.06127728 -0.14126623\nDim5.Student       0.01337823 -0.02580700\nDim1.Consumer      0.92622001  0.30224380\nDim2.Consumer     -0.26503374  0.82140275\nDim3.Consumer     -0.03482073 -0.14625306\nDim4.Consumer      0.04169320  0.06510167\nDim5.Consumer      0.11167354 -0.09098721\nDim1.Appreciation -0.70597932 -0.60347243\nDim2.Appreciation  0.57160688 -0.61681399\nDim3.Appreciation  0.07255077  0.20314385\nDim4.Appreciation  0.18315166 -0.19648391\nDim5.Appreciation  0.27993074 -0.14451047\n```\n:::\n:::\n\n:::\n\n\n\n\n\n\n",
    "supporting": [
      "2526-TP4-MFA-Correction_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}