{
  "hash": "19836435a6b885b585c330a2ccf37127",
  "result": {
    "markdown": "---\ntitle: \"TP4 - Multiple Factor Analysis (MFA)\"\nsubtitle: \"4modIA / 2025-2026\"\nformat:\n  html:\n    toc: true\n    toc-depth : 4\n    toc-location: left\n    number-sections: true\n    css: styles.css\n---\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ggplot2)\nlibrary(reshape2)\nlibrary(FactoMineR)\nlibrary(factoextra)\nlibrary(corrplot)\n```\n:::\n\n\n# Lecture des données\n\nDans ce TP, nous reprenons le jeu de données des vins qui a été utilisé pour illustrer le cours sur l'Analyse Factorielle Multiple (AFM). Le fichier de données est disponible sur la page moodle du cours `AnaDo_JeuDonnees_VinsJury.csv`. \n\nOn commence par lire le fichier de données à l'aide de la fonction `read.table()` en précisant quelques options. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nvins <- read.table(\"../../SlidesCours/Data/AnaDo_JeuDonnees_VinsJury.csv\",\n                  header=TRUE, sep=\";\",dec=\".\", \n                  row.names=1, check.names=FALSE, fileEncoding=\"latin1\")\nvins[,1]<-as.factor(vins[,1])\nhead(vins)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n                      cepage Int.av.agitation Int.ap.agitation Expression\nS Michaud          Sauvignon         7.750000            8.000   7.142857\nS Renaudie         Sauvignon         7.125000            7.625   7.000000\nS Trotignon        Sauvignon         7.125000            7.375   7.142857\nS Buisse Domaine   Sauvignon         5.500000            6.250   5.428571\nS Buisse Cristal   Sauvignon         6.000000            6.500   6.166667\nV Aub Silex          Vouvray         3.857143            4.250   4.428571\n                    O.fruit O.passion O.agrume O.fruit.confit O.vanille\nS Michaud          4.250000 2.4285714 5.714286      0.6666667 0.5000000\nS Renaudie         4.428571 3.1428571 5.250000      0.6666667 0.5000000\nS Trotignon        5.142857 4.0000000 5.250000      1.0000000 0.5000000\nS Buisse Domaine   4.250000 2.4285714 3.571429      1.5000000 0.6666667\nS Buisse Cristal   5.625000 3.1428571 3.500000      3.0000000 1.1428571\nV Aub Silex        3.857143 0.6666667 3.285714      2.8571429 0.8333333\n                    O.boisee   O.champ O.vegetale O.florale O.alcool\nS Michaud          0.3333333 0.3333333   6.500000  6.571429 1.666667\nS Renaudie         0.3333333 0.3333333   6.125000  6.428571 3.400000\nS Trotignon        0.3333333 0.5000000   4.625000  5.142857 2.833333\nS Buisse Domaine   0.5000000 0.3333333   4.571429  5.750000 2.600000\nS Buisse Cristal   0.8571429 0.2857143   4.285714  4.000000 3.142857\nV Aub Silex        1.0000000 1.6666667   4.375000  3.714286 2.428571\n                   Typicite.olf.chenin Int.attaque   Sucree Acide Amere\nS Michaud                     2.333333    6.000000 3.500000 5.875 4.125\nS Renaudie                    1.125000    6.428571 3.285714 6.750 3.750\nS Trotignon                   0.625000    6.571429 3.000000 6.125 4.125\nS Buisse Domaine              2.571429    5.142857 3.875000 5.625 2.500\nS Buisse Cristal              4.142857    5.571429 3.375000 6.625 5.000\nV Aub Silex                   6.000000    5.142857 7.875000 4.375 3.000\n                   Astringence Fraicheur Oxydation  Finesse\nS Michaud             1.428571  6.625000 0.4285714 5.285714\nS Renaudie            2.333333  6.625000 0.2857143 5.142857\nS Trotignon           2.375000  6.875000 0.4285714 5.285714\nS Buisse Domaine      3.000000  6.250000 0.4285714 4.571429\nS Buisse Cristal      3.125000  6.428571 1.0000000 5.571429\nV Aub Silex           2.375000  4.714286 1.8571429 5.571429\n                   Persistance.gustative Persistance.aromatique Int.couleur\nS Michaud                       7.142857               6.714286       5.000\nS Renaudie                      7.166667               6.571429       3.375\nS Trotignon                     6.142857               6.142857       3.000\nS Buisse Domaine                4.857143               5.142857       4.125\nS Buisse Cristal                6.142857               5.142857       3.625\nV Aub Silex                     5.857143               5.571429       4.000\n                   Nuance.couleur Impression.surface O.Av.Intensite_E\nS Michaud                3.857143                2.5         5.361111\nS Renaudie               3.285714                2.6         5.138889\nS Trotignon              2.428571                2.8         5.277778\nS Buisse Domaine         4.285714                3.5         4.444444\nS Buisse Cristal         3.857143                3.8         4.916667\nV Aub Silex              4.000000                3.5         4.361111\n                   O.Ap.Intensite_E O.Alcool_E O.Vegetale_E O.Champignon_E\nS Michaud                  6.384507   4.121799     3.119488       2.722222\nS Renaudie                 5.966049   4.002137     2.916667       2.416667\nS Trotignon                5.972222   3.805556     3.000000       2.916667\nS Buisse Domaine           5.333333   4.333333     3.305556       2.361111\nS Buisse Cristal           5.766838   4.150370     3.194444       3.222222\nV Aub Silex                5.772435   4.623439     3.777778       2.916667\n                   O.Fruitpassion_E O.Typicite_E G.Intensite_E Sucree_E\nS Michaud                  4.916667     5.861111      5.444444 4.861111\nS Renaudie                 6.027778     5.638889      5.444444 4.666667\nS Trotignon                6.111111     5.055556      5.094377 5.055556\nS Buisse Domaine           5.083333     5.916667      4.722222 4.916667\nS Buisse Cristal           3.927557     5.249967      5.472222 4.612545\nV Aub Silex                3.333333     5.222222      5.526474 6.833333\n                    Acide_E  Amere_E Astringent_E G.Alcool_E Equilibre_E\nS Michaud          5.194444 4.027778     3.694444   5.250000    5.194444\nS Renaudie         5.277778 3.527778     3.527778   4.916667    4.750000\nS Trotignon        4.916667 3.583333     3.708656   4.805556    5.222222\nS Buisse Domaine   4.750000 3.750000     3.388889   4.972222    4.750000\nS Buisse Cristal   5.555556 3.555556     3.611111   5.166667    4.590730\nV Aub Silex        4.638889 3.444444     2.750000   4.876872    4.388889\n                   G.Typicite_E O.Av.Intensite_C O.Ap.Intensite_C O.Alcool_C\nS Michaud              5.416667         4.045455         5.200166   4.087040\nS Renaudie             5.500000         5.318182         6.000000   3.492589\nS Trotignon            5.361111         5.590909         6.090909   3.681818\nS Buisse Domaine       5.342321         4.136364         5.000000   4.227273\nS Buisse Cristal       5.187078         5.500000         6.727273   4.363636\nV Aub Silex            5.750000         3.545455         5.045455   4.610850\n                   O.Vegetale_C O.Champignon_C O.Fruitpassion_C O.Typicite_C\nS Michaud              4.636364       4.490000         5.090909     4.488404\nS Renaudie             4.454545       3.909091         6.454545     4.636364\nS Trotignon            4.590909       2.272727         6.954545     4.889068\nS Buisse Domaine       4.454545       3.636364         4.272727     4.727273\nS Buisse Cristal       4.318182       4.590909         4.090909     4.793830\nV Aub Silex            4.227273       4.045455         4.545455     5.227273\n                   G.Intensite_C Sucree_C  Acide_C  Amere_C Astringent_C\nS Michaud               4.500000 4.772727 4.409091 5.136364     4.272727\nS Renaudie              5.181818 5.363636 5.409091 4.318182     4.545455\nS Trotignon             5.045455 4.863636 5.090909 4.727273     5.727273\nS Buisse Domaine        4.318182 5.363636 4.909091 4.545455     4.636364\nS Buisse Cristal        5.727273 4.227273 6.409091 4.818182     3.954545\nV Aub Silex             4.807500 6.681818 4.500000 3.545455     3.727273\n                   G.Alcool_C Equilibre_C G.Typicite_C Juge1 Juge2 Juge3 Juge4\nS Michaud            5.090909    5.189683     5.000000     7   5.5   2.5     1\nS Renaudie           5.045455    5.090909     4.636364     6   5.5   2.5     2\nS Trotignon          4.603636    5.090909     4.772727     3   4.0   3.0     3\nS Buisse Domaine     4.909091    4.181818     4.272727     6   4.0   2.0     1\nS Buisse Cristal     4.772727    4.106768     4.818182     6   5.0   2.5     2\nV Aub Silex          4.363636    5.566567     5.590909     8   5.0   6.0     6\n                   Juge5 Juge6 Juge7 Juge8 Juge9 Juge10 Juge11 Juge12 Juge13\nS Michaud            5.0   3.5   4.5     1     1      1    2.5      5      1\nS Renaudie           3.5   1.0   3.5     2     8      1    2.5      5      1\nS Trotignon          4.5   2.0   4.0     2     6      4    2.0      8      1\nS Buisse Domaine     3.0   3.0   3.5     4     7      2    2.0      4      1\nS Buisse Cristal     4.0   2.5   4.0     1     3      2    2.5      2      1\nV Aub Silex          3.5   4.5   3.5     3    10      6    5.5      9      6\n                   Juge14 Juge15 Juge16 Juge17 Juge18 Juge19 Juge20 Juge21\nS Michaud             4.0    3.0      1    2.0    6.0    5.5    3.5      1\nS Renaudie            5.0    4.0      1    1.5    4.0    4.5    2.5      2\nS Trotignon           5.0    4.5      6    3.0    7.5    5.5    3.5      2\nS Buisse Domaine      6.0    3.0      3    4.0    3.0    2.5    2.5      6\nS Buisse Cristal      7.5    3.0      1    2.0    3.0    2.5    4.0      1\nV Aub Silex           8.0    4.0      6    5.5    6.0    5.5    4.5      2\n                   Juge22 Juge23 Juge24 Juge25 Juge26 Juge27 Juge28 Juge29\nS Michaud             2.5      5    4.5    4.0    3.0    1.5    2.0    1.5\nS Renaudie            3.5      2    1.0    4.0    3.0    2.5    2.5    1.5\nS Trotignon           2.5      4    3.0    5.0    4.5    3.5    2.5    1.5\nS Buisse Domaine      1.5      1    3.0    4.0    3.5    3.0    2.0    2.0\nS Buisse Cristal      1.5      2    3.5    2.0    4.0    4.0    2.0    3.5\nV Aub Silex           4.0      4    4.0    3.5    5.5    3.0    2.5    3.0\n                   Juge30 Juge31 Juge32 Juge33 Juge34 Juge35 Juge36 Juge37\nS Michaud             3.5    2.0    4.5    6.5    2.5      3    3.5      2\nS Renaudie            5.0    2.0    2.0    6.0    2.5      8    1.5      2\nS Trotignon           5.0    2.5    5.5    6.0    4.0      6    4.0      5\nS Buisse Domaine      4.5    3.0    5.0    7.0    4.5      3    4.0      4\nS Buisse Cristal      7.0    2.5    2.5    7.0    2.0      6    4.0      3\nV Aub Silex           8.0    7.5    8.5    9.5    5.0      4    4.0      4\n                   Juge38 Juge39 Juge40 Juge41 Juge42 Juge43 Juge44 Juge45\nS Michaud             7.0    2.5    3.5    5.5      4      6    3.5      1\nS Renaudie            5.5    2.5    2.0    4.0      3      3    5.0      2\nS Trotignon           4.5    4.0    8.5    5.0      3      7    4.0      1\nS Buisse Domaine      3.5    3.0    5.5    5.5      3      8    2.5      4\nS Buisse Cristal      4.0    3.0    2.0    5.0      2      4    4.0      1\nV Aub Silex           4.5    7.5    7.5    8.0      5      7    7.5      7\n                   Juge46 Juge47 Juge48 Juge49 Juge50 Juge51 Juge52 Juge53\nS Michaud               4    4.5    3.5    5.0      6    3.5    4.5    2.5\nS Renaudie              4    2.0    3.0    4.5      6    2.5    3.5    1.0\nS Trotignon             4    3.5    3.5    5.5      5    3.0    4.0    3.0\nS Buisse Domaine        1    5.0    3.0    8.0      5    2.0    3.0    3.0\nS Buisse Cristal        3    2.0    3.5    8.5      4    3.5    3.0    4.0\nV Aub Silex             7    8.5    6.0    7.0      7    1.0    6.5    5.5\n                   Juge54 Juge55 Juge56 Juge57 Juge58 Juge59 Juge60\nS Michaud             6.5    1.0      6    2.0      8    4.5      5\nS Renaudie            6.5    1.0      2    4.0      1    2.0      1\nS Trotignon           7.5    1.5      3    1.0      1    1.0      2\nS Buisse Domaine      4.0    2.5      3    1.5      6    5.0      3\nS Buisse Cristal      7.0    3.0      1    1.0      4    5.5      2\nV Aub Silex           7.0    3.0      7    2.0      4    6.0      6\n```\n:::\n:::\n\n\n# Groupes de variables\n\n**Question :** Pour rappel, le jeu de données est composé de plusieurs groupes de variables\n\n- *cepage* : une variable qualitative indiquant le cépage\n- *Expert* : 27 variables quantitatives de descripteurs sensoriels d'un jury d'experts\n- *Etudiants* : 15 variables quantitatives de descripteurs sensoriels d'un jury d'étudiants (nom finissant par \"_E\")\n- *Consommateurs* : 15 variables quantitatives de descripteurs sensoriels d'un jury de consommateurs (nom finissant par \"_C\")\n- *Appreciation* : note de 60 consommateurs\n\nCréez des jeux de données distincts par groupe et quelques statistiques descriptives pour chaque groupe.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nDataExpert<-...\nDataStudent<-...\nDataConsumer<-...\nAppreciation<-...\ncepage<-...\n```\n:::\n\n\n\n# ACP pour chaque jury\n\n**Question :** Faites une ACP pour le jeu de données des descripteurs sensoriels pour chaque jury séparément (à l'aide de la fonction `PCA`de la librairie `FactoMineR`). Analysez les résultats. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nACPExpert<-PCA(DataExpert,.....)\nACPStudent<-PCA(DataStudent, ....)\nACPConsumer<-PCA(DataConsumer, ....)\nfviz_eig(....)\nfviz_pca_ind(....)\nfviz_pca_var(.....)\n```\n:::\n\n\n\n# AFM avec FactoMineR\n\n**Question :** Faites une analyse factorielle multiple (AFM) avec la fonction `MFA()` de la librairie `FactoMineR` sur le jeu de données `vins`. Le cépage et le groupe de variables `Appreciation` sont considérés comme des groupes de variables supplémentaires. Explorez la structure du contenu de la sortie `resMFA`. Retrouvez-vous les ACP faites dans la question précédente ?\n\n\n::: {.cell}\n\n```{.r .cell-code}\nresMFA<-MFA(.....)\nresMFA\n```\n:::\n\n\n# Lien entre AFM et ACP\n\n**Question :** L'analyse factorielle multiple est une ACP sur un jeu de données particulier que l'on appelle `DataMFA`. Retrouvez numériquement ce résultat. \n\n\n::: {.cell}\n\n```{.r .cell-code}\ndExpert<-....\ndStudent<-...\ndConsumer<-...\nDataMFA<-cbind(dexpert,dStudent,dConsumer)\nDataMFA<-data.frame(cepage=cepage,DataMFA)\n\nresglobal<-PCA(DataMFA,....)\n```\n:::\n\n\n\n**Question :** Déterminez les valeurs de $\\mathcal L_g$ entre les groupes de variables. Comparez avec les valeurs dans `resMFA$group$Lg`. Que représentent les termes diagonaux ? Quel est le lien avec les valeurs propres des ACP séparées ? Vérifiez numériquement.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# A COMPLETER\n```\n:::\n\n\n**Question :** Comment est construit le graphique donné par la fonction suivante ? Commentez-le.  \n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfviz_mfa_var(resMFA,\"group\",repel=TRUE)\n```\n:::\n\n\n\n**Question :** Quel est le lien entre les valeurs de $\\mathcal L_g(j,j')$ et de $RV(j,j')$ ? Vérifiez numériquement et commentez les résultats. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nRV<- ...\nresMFA$group$RV\n```\n:::\n\n\n\n**Question :** On s'intéresse maintenant aux points partiels qui sont représentés à l'aide de la commande suivante. Comment ces points sont-ils calculés ? Vérifiez numériquement. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nfviz_mfa_ind(resMFA,partial = \"all\",repel=T)+theme(legend.position=\"bottom\")\n```\n:::\n\n\n\n**Question :** Que représente la fonction suivante ? Retrouvez le lien avec les composantes principales des différentes ACP. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nfviz_mfa_axes(resMFA,repel=T)\n\n# A COMPLETER\n```\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}