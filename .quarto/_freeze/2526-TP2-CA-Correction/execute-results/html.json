{
  "hash": "1330346d4412d7ba40c458ba7d475c32",
  "result": {
    "markdown": "---\ntitle: \"TP2 - Correspondence Analysis - Correction\"\nsubtitle: \"4modIA / 2025-2026\"\nformat:\n  html:\n    toc: true\n    toc-depth : 4\n    toc-location: left\n    number-sections: true\n    css: styles.css\n    header-includes:\n    - \\usepackage{dsfont}\n---\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ggplot2)\nlibrary(FactoMineR)\nlibrary(factoextra)\nlibrary(reticulate)\nlibrary(ggpubr)\n```\n:::\n\n\n\n# Données de sociologie\n\n## Description \n\nNous nous intéressons dans ce TP à des données issues du travail du sociologue Pierre Bourdieu. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nSocio<-read.table(\"DataSocio.txt\",header=T)\n```\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n|     | DR  | SCE | LET | SC  | MD  | PH  | PD | IUT |\n|:----|:---:|:---:|:---:|:---:|:---:|:---:|:--:|:---:|\n|EAG  | 80  | 36  | 134 | 99  | 65  | 28  | 11 | 58  |\n|SAG  |  6  |  2  | 15  |  6  |  4  |  1  | 1  |  4  |\n|PT   | 168 | 74  | 312 | 137 | 208 | 53  | 21 | 62  |\n|PLCS | 470 | 191 | 806 | 400 | 876 | 164 | 45 | 79  |\n|CM   | 236 | 99  | 493 | 264 | 281 | 56  | 36 | 87  |\n|EMP  | 145 | 52  | 281 | 133 | 135 | 30  | 20 | 54  |\n|OUV  | 16  |  6  | 27  | 11  |  8  |  2  | 2  |  8  |\n|AUT  | 305 | 115 | 624 | 247 | 301 | 47  | 42 | 90  |\n:::\n:::\n\n\nLa table de contingence `Socio` contient les effectifs des étudiants de l’enquête.\n\n::: columns\n::: {.column width=\"45%\"}\nEn ligne, nous avons les différentes catégories \nsocioprofessionnelles pour le chef de famille : \n\n- EAG : exploitant agricole\n- SAG : salarié agricole \n- PT : patron \n- PLCS : profession libérale et cadre supérieur \n- CM : cadre moyen\n- EMP : employé\n- OUV : ouvrier \n- AUT : autre\n:::\n::: {.column width=\"45%\"}\nEn colonne, nous retrouvons les types d'études poursuivies\n\n- DR : droit \n- SCE : sciences économiques \n- LET : lettres \n- SC : sciences \n- MD : médecine ou dentaire \n- PH : pharmacie \n- PD : pluridisciplinaire \n- IUT : IUT\n:::\n:::\n\nNous pouvons visualiser cette table de contingence à l'aide de la fonction `ggballoonplot()` de la librairie `ggpubr`.  \n\n\n::: {.cell}\n\n```{.r .cell-code}\nggballoonplot(Socio, fill = \"value\")+\n     scale_fill_viridis_c(option = \"C\")\n```\n\n::: {.cell-output-display}\n![](2526-TP2-CA-Correction_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\n**Question :** A l'aide de la fonction `chisq.test()`, testez s'il y a indépendance ou pas entre les deux variables qualitatives. \n\n\n::: {.cell}\n\n```{.r .cell-code}\n# A COMPLETER\n```\n:::\n\n\n:::{.callout-note custom-style=\"correction\" appearance=\"simple\" title=\"Correction\"}\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nchisq.test(Socio)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tPearson's Chi-squared test\n\ndata:  Socio\nX-squared = 326.9, df = 49, p-value < 2.2e-16\n```\n:::\n:::\n\n:::\n\n\n## Analyse des correspondances à la main\n\nAfin d'assimiler le cours, nous allons tout d'abord faire l'analyse des correspondances \"à la main\". \n\n**Question :** La première étape consiste à définir les matrices $F_X$ et $F_Y$ contenant les profils lignes et colonnes respectivement, associés à ces données. Construisez ces deux matrices à l'aide des fonctions `diag()`, `rowSums()`, `colSums()`. \n\n\n::: {.cell}\n\n```{.r .cell-code}\n# A COMPLETER\nFX<- ...\nrownames(FX) <- rownames(Socio)\nFY<-  ...\nrownames(FY) <- colnames(Socio)\n```\n:::\n\n\n:::{.callout-note custom-style=\"correction\" appearance=\"simple\" title=\"Correction\"}\n\n- $F_X$ est une matrice $I\\times J$ où chaque ligne contient un profil-ligne\n- $F_Y$ est une matrice $J\\times I$ où chaque ligne contient un profil-colonne \n\n\n::: {.cell}\n\n```{.r .cell-code}\nFX<- diag(1/rowSums(Socio)) %*% as.matrix(Socio)\nrownames(FX) <- rownames(Socio)  \n\nFY<-  diag(1/colSums(Socio)) %*% t(as.matrix(Socio))\nrownames(FY) <- colnames(Socio) \n```\n:::\n\n:::\n\n\n**Question :** Faites une ACP sur les profils lignes\n\n+ matrice des données $F_X$ \n+ matrice des poids $W=W_X = \\mbox{diag}(n_{1+}/n,\\ldots,n_{I+}/n)$ \n+ métrique associée à la matrice \n$M = W_Y^{-1}=\\mbox{diag}(n/n_{+1},\\ldots,n/n_{+J})$\n\nPour cela, déterminez les valeurs propres et vecteurs propres à l'aide de la fonction `eigen()` d'une matrice bien choisie. \n\n\n::: {.cell}\n\n```{.r .cell-code}\n# A COMPLETER\nACPX<-eigen(....)\n```\n:::\n\n\n\n:::{.callout-note custom-style=\"correction\" appearance=\"simple\" title=\"Correction\"}\n\n\nOn applique l'isométrie sur les données centrée et on fait la décomposition spectrale de la matrice de covariance associée (avec les poids $W_X$). \n\n$\\tilde F_X= F_X - \\mathbb{1}_I \\mu_X$ pour les données centrées et $B_X = \\tilde F_X W_Y^{-1/2}$ pour l'application de l'isométrie.\nOn cherche la décomposition spectrale de $\\Gamma_B = B_X' W_X B_X = W_Y^{-1/2} \\Gamma_X W_Y^{-1/2}$ où $\\Gamma_X = \\tilde F_X'W_X\\tilde F_X$.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nn <- sum(rowSums(Socio))\nmuX<-colSums(Socio)/n\nmuY<-rowSums(Socio)/n\nFtildeX<-(FX - rep(1,nrow(FX))%*%t(muX)) # on centre les données\nBX<-FtildeX%*%diag(sqrt(1/muX)) # on applique l'isométrie aux données \n# on veut la décomposition spectrale de BX' WX BX\nWX<-diag(muY)\nGammaB<-t(BX)%*%WX%*%BX\nACPX<-eigen(GammaB)\n```\n:::\n\n\nOn peut aussi faire la décomposition spectrale de $\\Gamma_X W_{Y}^{-1}$\n\n\n::: {.cell}\n\n```{.r .cell-code}\nGamma<-t(FtildeX)%*%WX%*%FtildeX\nAuxX<-eigen(Gamma%*%diag(1/muX))\n```\n:::\n\n\nOn retrouve bien que l'on a les mêmes valeurs propres dans les deux cas\n\n\n::: {.cell}\n\n```{.r .cell-code}\nround(AuxX$values,4)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.0293 0.0062 0.0012 0.0002 0.0001 0.0000 0.0000 0.0000\n```\n:::\n\n```{.r .cell-code}\nround(ACPX$values,4)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.0293 0.0062 0.0012 0.0002 0.0001 0.0000 0.0000 0.0000\n```\n:::\n:::\n\n et la liaison des vecteurs propres : $v_s$ vecteur propre de $\\Gamma_X W_Y^{-1}$ alors $W_Y^{-1/2}v_s$ est vecteur propre de $W_Y^{-1/2} \\Gamma_X W_Y^{-1/2}$ (à normalisation près car les vecteurs propres rendus par eigen sont de norme 1).\n \n\n::: {.cell}\n\n```{.r .cell-code}\nus<-diag(1/sqrt(muX))%*%AuxX$vectors[,1]\nus/sqrt(sum(us^2))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n            [,1]\n[1,] -0.06267469\n[2,] -0.02580071\n[3,] -0.25595589\n[4,] -0.19430833\n[5,]  0.74080364\n[6,]  0.21466628\n[7,] -0.15118157\n[8,] -0.52384115\n```\n:::\n\n```{.r .cell-code}\nACPX$vectors[,1]\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] -0.06267469 -0.02580071 -0.25595589 -0.19430833  0.74080364  0.21466628\n[7] -0.15118157 -0.52384115\n```\n:::\n:::\n\n\n:::\n\n\n**Question :** Vérifiez que l'ACP des profils-lignes peut se retrouver par la décomposition spectrale de $(F_YF_X)'$. Que remarque-t-on concernant les valeurs propres. \n\n\n::: {.cell}\n\n```{.r .cell-code}\n# A COMPLETER\n```\n:::\n\n\n\n:::{.callout-note custom-style=\"correction\" appearance=\"simple\" title=\"Correction\"}\n\n\nC'est la décomposition spectrale de $(F_Y F_X)'$ du cours. \nOn retrouve la valeur propre 1 à la place d'une valeur propre 0 précédemment, avec le vecteur propre $\\mu_X$.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nAux<-eigen(t(FY %*% FX))\nround(Aux$values,4)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 1.0000 0.0293 0.0062 0.0012 0.0002 0.0001 0.0000 0.0000\n```\n:::\n:::\n\n\n:::\n\n**Question :** Déterminez les composantes principales $C^{(row)}_s$.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nCrow<-...\n```\n:::\n\n\n\n:::{.callout-note custom-style=\"correction\" appearance=\"simple\" title=\"Correction\"}\n\n\nOn récupère les composantes principales \n\n\n::: {.cell}\n\n```{.r .cell-code}\nr<-min(nrow(Socio),ncol(Socio))-1\nCrow<- BX %*% ACPX$vectors[,1:r]\nround(Crow,3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n       [,1]   [,2]   [,3]   [,4]   [,5]   [,6]   [,7]\nEAG  -0.280  0.248 -0.001  0.012 -0.002  0.003  0.001\nSAG  -0.362 -0.017  0.026 -0.009  0.105  0.049 -0.002\nPT   -0.026  0.036  0.060 -0.024 -0.001 -0.003  0.000\nPLCS  0.223  0.017 -0.001  0.005  0.001  0.001  0.000\nCM   -0.092 -0.004 -0.057 -0.011 -0.003  0.002 -0.001\nEMP  -0.148 -0.023 -0.002  0.011  0.009 -0.017 -0.001\nOUV  -0.340  0.003  0.117  0.057 -0.026  0.021 -0.007\nAUT  -0.112 -0.107  0.013  0.004 -0.003  0.003  0.001\n```\n:::\n:::\n\n\n:::\n\n**Question :** Faites une ACP des profils-colonnes avec la matrice des poids\n$W=W_Y$ et la métrique associée à la matrice $M = W_X^{-1}$. Déterminez les composantes principales $C^{(col)}_s$.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# A COMPLETER\nACPY<-eigen(...)\nCcol<-....\n```\n:::\n\n\n:::{.callout-note custom-style=\"correction\" appearance=\"simple\" title=\"Correction\"}\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nFtildeY<-(FY - rep(1,nrow(FY))%*%t(muY)) # on centre les données\nBY<-FtildeY%*%diag(sqrt(1/muY)) # on applique l'isométrie aux données \n# on veut la décomposition spectrale de BX' WX BX\nWY<-diag(muX)\nGammaBY<-t(BY)%*%WY%*%BY\nACPY<-eigen(GammaBY)\n\nround(ACPY$values,4)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.0293 0.0062 0.0012 0.0002 0.0001 0.0000 0.0000 0.0000\n```\n:::\n\n```{.r .cell-code}\nACPY$vectors\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n            [,1]         [,2]        [,3]        [,4]        [,5]        [,6]\n[1,] -0.39241606  0.759302173 -0.00875737 -0.24027116 -0.06544383  0.11701036\n[2,] -0.14050870 -0.013993601  0.05105758  0.04876812  0.85390495  0.47402539\n[3,] -0.05106744  0.157530880  0.60375880  0.67773458 -0.05479904 -0.12576702\n[4,]  0.76241027  0.128128390 -0.02323895 -0.22780538  0.06145826  0.06544516\n[5,] -0.22420335 -0.023423861 -0.70467494  0.36293218 -0.17002393  0.13293248\n[6,] -0.26765437 -0.088714350 -0.02054192 -0.28291170  0.34662750 -0.76845418\n[7,] -0.18875612  0.003664323  0.32580609 -0.44154124 -0.29819176  0.28835544\n[8,] -0.29129839 -0.611227605  0.17062636 -0.14817061 -0.14766958  0.22397850\n             [,7]       [,8]\n[1,] -0.368879633 0.24003420\n[2,]  0.129712020 0.06631244\n[3,]  0.114927832 0.34161179\n[4,] -0.008123607 0.58459573\n[5,]  0.315161745 0.41831991\n[6,]  0.183079274 0.30957946\n[7,]  0.694378897 0.09497464\n[8,] -0.467783294 0.44686049\n```\n:::\n\n```{.r .cell-code}\nCcol<- BY %*% ACPY$vectors[,1:r]\nround(Ccol,3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n      [,1]   [,2]   [,3]   [,4]   [,5]   [,6]   [,7]\nDR  -0.027 -0.027  0.031 -0.020 -0.005 -0.008  0.000\nSCE -0.017  0.021  0.031  0.018 -0.026  0.007 -0.001\nLET -0.079 -0.081  0.003  0.008  0.005  0.001  0.000\nSC  -0.087  0.056 -0.073 -0.003 -0.003 -0.003  0.000\nMD   0.275  0.014 -0.003 -0.004  0.003  0.006  0.000\nPH   0.177  0.191  0.040  0.027  0.008 -0.019  0.000\nPD  -0.183 -0.062 -0.019  0.020 -0.007 -0.007  0.006\nIUT -0.401  0.193  0.043 -0.009  0.010  0.013  0.000\n```\n:::\n:::\n\n:::\n\n**Question :** Quelle relation permet de relier $C^{(row)}_s$ et $C^{(col)}_s$ ? Vérifiez numériquement.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# A COMPLETER\n```\n:::\n\n\n:::{.callout-note custom-style=\"correction\" appearance=\"simple\" title=\"Correction\"}\n\n\nFormule de transition\n$$\nC_s^{(row)}(i) = \\frac{1}{\\sqrt{\\lambda_s}} \\underset{j=1}{\\stackrel{J}{\\sum}} \\frac{n_{i j}}{n_{i +}} C_s^{(col)}(j)\n\\ \\ \\textrm{ and }\\ \\\nC_s^{(col)}(j) = \\frac{1}{\\sqrt{\\lambda_s}} \\underset{i=1}{\\stackrel{I}{\\sum}} \\frac{n_{i j}}{n_{+ j}} C_s^{(row)}(i)\n$$\n\n\n::: {.cell}\n\n```{.r .cell-code}\nCcolbis <- FY %*% Crow %*% diag(1/sqrt(ACPX$values[1:r]))\nCcolbis[,1:3]\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n           [,1]        [,2]         [,3]\nDR  -0.02673760 -0.02738738  0.030934404\nSCE -0.01733356  0.02074837  0.030772619\nLET -0.07947264 -0.08148735  0.002900559\nSC  -0.08691835  0.05583873 -0.072672569\nMD   0.27538820  0.01430081 -0.003426946\nPH   0.17717047  0.19108477  0.040374757\nPD  -0.18254875 -0.06172191 -0.018975495\nIUT -0.40140103  0.19319339  0.043149234\n```\n:::\n\n```{.r .cell-code}\nCcol[,1:3] \n```\n\n::: {.cell-output .cell-output-stdout}\n```\n           [,1]        [,2]         [,3]\nDR  -0.02673760 -0.02738738  0.030934404\nSCE -0.01733356  0.02074837  0.030772619\nLET -0.07947264 -0.08148735  0.002900559\nSC  -0.08691835  0.05583873 -0.072672569\nMD   0.27538820  0.01430081 -0.003426946\nPH   0.17717047  0.19108477  0.040374757\nPD  -0.18254875 -0.06172191 -0.018975495\nIUT -0.40140103  0.19319339  0.043149234\n```\n:::\n:::\n\n:::\n\n## Analyse des correspondances avec FactoMineR\n\n**Question :** A l'aide de la fonction `CA()` de la librairie `FactoMineR`, faites une analyse des correspondances du jeu de données Socio. Retrouvez les pvaleurs, les composantes principales, .... par rapport aux calculs précédents. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nresCA<-CA(.....) # A COMPLETER\n```\n:::\n\n\n:::{.callout-note custom-style=\"correction\" appearance=\"simple\" title=\"Correction\"}\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nresCA<-CA(Socio,graph=F,ncp=7)\nround(resCA$eig,5)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n      eigenvalue percentage of variance cumulative percentage of variance\ndim 1    0.02926               79.39074                          79.39074\ndim 2    0.00617               16.73538                          96.12612\ndim 3    0.00116                3.15444                          99.28056\ndim 4    0.00015                0.40904                          99.68960\ndim 5    0.00007                0.17915                          99.86875\ndim 6    0.00005                0.12881                          99.99757\ndim 7    0.00000                0.00243                         100.00000\n```\n:::\n\n```{.r .cell-code}\nround(ACPX$values,3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.029 0.006 0.001 0.000 0.000 0.000 0.000 0.000\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nround(resCA$row$coord,3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n      Dim 1  Dim 2  Dim 3  Dim 4  Dim 5  Dim 6  Dim 7\nEAG   0.280  0.248 -0.001 -0.012  0.002 -0.003 -0.001\nSAG   0.362 -0.017  0.026  0.009 -0.105 -0.049  0.002\nPT    0.026  0.036  0.060  0.024  0.001  0.003  0.000\nPLCS -0.223  0.017 -0.001 -0.005 -0.001 -0.001  0.000\nCM    0.092 -0.004 -0.057  0.011  0.003 -0.002  0.001\nEMP   0.148 -0.023 -0.002 -0.011 -0.009  0.017  0.001\nOUV   0.340  0.003  0.117 -0.057  0.026 -0.021  0.007\nAUT   0.112 -0.107  0.013 -0.004  0.003 -0.003 -0.001\n```\n:::\n\n```{.r .cell-code}\nround(Crow,3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n       [,1]   [,2]   [,3]   [,4]   [,5]   [,6]   [,7]\nEAG  -0.280  0.248 -0.001  0.012 -0.002  0.003  0.001\nSAG  -0.362 -0.017  0.026 -0.009  0.105  0.049 -0.002\nPT   -0.026  0.036  0.060 -0.024 -0.001 -0.003  0.000\nPLCS  0.223  0.017 -0.001  0.005  0.001  0.001  0.000\nCM   -0.092 -0.004 -0.057 -0.011 -0.003  0.002 -0.001\nEMP  -0.148 -0.023 -0.002  0.011  0.009 -0.017 -0.001\nOUV  -0.340  0.003  0.117  0.057 -0.026  0.021 -0.007\nAUT  -0.112 -0.107  0.013  0.004 -0.003  0.003  0.001\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nround(resCA$col$coord,3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n     Dim 1  Dim 2  Dim 3  Dim 4  Dim 5  Dim 6  Dim 7\nDR   0.027 -0.027  0.031 -0.020  0.005  0.008  0.000\nSCE  0.017  0.021  0.031  0.018  0.026 -0.007 -0.001\nLET  0.079 -0.081  0.003  0.008 -0.005 -0.001  0.000\nSC   0.087  0.056 -0.073 -0.003  0.003  0.003  0.000\nMD  -0.275  0.014 -0.003 -0.004 -0.003 -0.006  0.000\nPH  -0.177  0.191  0.040  0.027 -0.008  0.019  0.000\nPD   0.183 -0.062 -0.019  0.020  0.007  0.007  0.006\nIUT  0.401  0.193  0.043 -0.009 -0.010 -0.013  0.000\n```\n:::\n\n```{.r .cell-code}\nround(Ccol,3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n      [,1]   [,2]   [,3]   [,4]   [,5]   [,6]   [,7]\nDR  -0.027 -0.027  0.031 -0.020 -0.005 -0.008  0.000\nSCE -0.017  0.021  0.031  0.018 -0.026  0.007 -0.001\nLET -0.079 -0.081  0.003  0.008  0.005  0.001  0.000\nSC  -0.087  0.056 -0.073 -0.003 -0.003 -0.003  0.000\nMD   0.275  0.014 -0.003 -0.004  0.003  0.006  0.000\nPH   0.177  0.191  0.040  0.027  0.008 -0.019  0.000\nPD  -0.183 -0.062 -0.019  0.020 -0.007 -0.007  0.006\nIUT -0.401  0.193  0.043 -0.009  0.010  0.013  0.000\n```\n:::\n:::\n\n:::\n\n**Question :** Tracez les modalités sur le premier plan factoriel et interprétez.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfviz_ca(....) # A COMPLETER\n```\n:::\n\n\n:::{.callout-note custom-style=\"correction\" appearance=\"simple\" title=\"Correction\"}\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfviz_ca(resCA,repel=TRUE)\n```\n\n::: {.cell-output-display}\n![](2526-TP2-CA-Correction_files/figure-html/unnamed-chunk-27-1.png){width=672}\n:::\n:::\n\n:::\n\n**Question :** Etudiez la qualité de représentation de chaque catégorie socioprofessionnelle et de chaque type d'étude suivie.\nCommentez. Vous pouvez utiliser les fonctions `fviz_cos2()`, `fviz_ca_row()`et `fviz_ca_col()` pour la visualisation.  \n\n\n::: {.cell}\n\n```{.r .cell-code}\n# A COMPLETER\n```\n:::\n\n\n:::{.callout-note custom-style=\"correction\" appearance=\"simple\" title=\"Correction\"}\n\n\n- $Cos^2$ pour les lignes :\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfviz_cos2(resCA,choice=c(\"row\"),axes=c(1))\n```\n\n::: {.cell-output-display}\n![](2526-TP2-CA-Correction_files/figure-html/unnamed-chunk-29-1.png){width=672}\n:::\n\n```{.r .cell-code}\nfviz_cos2(resCA,choice=c(\"row\"),axes=c(2))\n```\n\n::: {.cell-output-display}\n![](2526-TP2-CA-Correction_files/figure-html/unnamed-chunk-29-2.png){width=672}\n:::\n\n```{.r .cell-code}\nfviz_ca_row(resCA,col.row=\"cos2\",gradient.cols=c(\"white\",\"red\"),repel=T)\n```\n\n::: {.cell-output-display}\n![](2526-TP2-CA-Correction_files/figure-html/unnamed-chunk-29-3.png){width=672}\n:::\n:::\n\n\n- $Cos^2$ pour les colonnes :\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfviz_cos2(resCA,choice=c(\"col\"),axes=c(1))\n```\n\n::: {.cell-output-display}\n![](2526-TP2-CA-Correction_files/figure-html/unnamed-chunk-30-1.png){width=672}\n:::\n\n```{.r .cell-code}\nfviz_cos2(resCA,choice=c(\"col\"),axes=c(2))\n```\n\n::: {.cell-output-display}\n![](2526-TP2-CA-Correction_files/figure-html/unnamed-chunk-30-2.png){width=672}\n:::\n\n```{.r .cell-code}\nfviz_ca_col(resCA,col.col=\"cos2\",gradient.cols=c(\"white\",\"red\"),repel=T)\n```\n\n::: {.cell-output-display}\n![](2526-TP2-CA-Correction_files/figure-html/unnamed-chunk-30-3.png){width=672}\n:::\n:::\n\n:::\n\n**Question :** Etudiez les contributions de chaque catégorie socioprofessionnelle et de chaque type d'étude suivie pour le premier axe. Vous pouvez utiliser les fonctions `fviz_contrib()`, `fviz_ca_row()`et `fviz_ca_col()` pour la visualisation. \n\n\n::: {.cell}\n\n```{.r .cell-code}\n# A COMPLETER\n```\n:::\n\n\n:::{.callout-note custom-style=\"correction\" appearance=\"simple\" title=\"Correction\"}\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfviz_contrib(resCA,choice=c(\"row\"))\n```\n\n::: {.cell-output-display}\n![](2526-TP2-CA-Correction_files/figure-html/unnamed-chunk-32-1.png){width=672}\n:::\n\n```{.r .cell-code}\nfviz_ca_row(resCA,col.row=\"contrib\",gradient.cols=c(\"white\",\"red\"),repel=T)\n```\n\n::: {.cell-output-display}\n![](2526-TP2-CA-Correction_files/figure-html/unnamed-chunk-32-2.png){width=672}\n:::\n\n```{.r .cell-code}\nfviz_contrib(resCA,choice=c(\"col\"))\n```\n\n::: {.cell-output-display}\n![](2526-TP2-CA-Correction_files/figure-html/unnamed-chunk-32-3.png){width=672}\n:::\n\n```{.r .cell-code}\nfviz_ca_col(resCA,col.col=\"contrib\",gradient.cols=c(\"white\",\"red\"),repel=T)\n```\n\n::: {.cell-output-display}\n![](2526-TP2-CA-Correction_files/figure-html/unnamed-chunk-32-4.png){width=672}\n:::\n:::\n\n:::\n\n## Analyse des correspondances avec Python\n\nDans cette partie, nous allons faire une analyse des correspondances à l'aide de la librairie `prince` en Python. \nRetrouvez les éléments vus précédemment à l'aide des commandes suivantes. \n\n\n::: {.cell}\n\n```{.python .cell-code}\nimport prince\n\nSociopy=r.Socio\nca = prince.CA(\n    n_components=5,\n    n_iter=3,\n    copy=True,\n    check_input=True,\n    engine='sklearn',\n    random_state=42\n)\nca = ca.fit(Sociopy)\n```\n:::\n\n::: {.cell}\n\n```{.python .cell-code}\nca.eigenvalues_summary\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n          eigenvalue % of variance % of variance (cumulative)\ncomponent                                                    \n0              0.029        79.39%                     79.39%\n1              0.006        16.74%                     96.13%\n2              0.001         3.15%                     99.28%\n3              0.000         0.41%                     99.69%\n4              0.000         0.18%                     99.87%\n```\n:::\n:::\n\n::: {.cell}\n\n```{.python .cell-code}\nca.row_coordinates(Sociopy).head()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n             0         1         2         3         4\nEAG  -0.279657  0.248443  0.001244 -0.012291 -0.002216\nSAG  -0.362461 -0.016574 -0.026254  0.009030  0.104640\nPT   -0.025572  0.036217 -0.060264  0.024360 -0.001304\nPLCS  0.223093  0.017214  0.001355 -0.004785  0.000854\nCM   -0.091682 -0.004398  0.057439  0.010653 -0.003303\n```\n:::\n\n```{.python .cell-code}\nca.column_coordinates(Sociopy).head()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n            0         1         2         3         4\nDR  -0.026738 -0.027387 -0.030934 -0.020189 -0.004686\nSCE -0.017334  0.020748 -0.030773  0.017674 -0.025580\nLET -0.079473 -0.081487 -0.002901  0.007542  0.005415\nSC  -0.086918  0.055839  0.072673 -0.003313 -0.003238\nMD   0.275388  0.014301  0.003427 -0.003940  0.002594\n```\n:::\n:::\n\n::: {.cell}\n\n```{.python .cell-code}\nca.plot(\n    Sociopy,\n    x_component=0,\n    y_component=1,\n    show_row_markers=True,\n    show_column_markers=True,\n    show_row_labels=True,\n    show_column_labels=True\n)\n```\n\n::: {.cell-output-display}\n```{=html}\n<!DOCTYPE html>\n<html>\n<head>\n  <meta charset=\"UTF-8\">\n  <style>\n    #unnamed-chunk-36-altair-viz.vega-embed {\n      width: 100%;\n      display: flex;\n    }\n\n    #unnamed-chunk-36-altair-viz.vega-embed details,\n    #unnamed-chunk-36-altair-viz.vega-embed details summary {\n      position: relative;\n    }\n  </style>\n  <script type=\"text/javascript\" src=\"https://cdn.jsdelivr.net/npm/vega@5\"></script>\n  <script type=\"text/javascript\" src=\"https://cdn.jsdelivr.net/npm/vega-lite@5.20.1\"></script>\n  <script type=\"text/javascript\" src=\"https://cdn.jsdelivr.net/npm/vega-embed@6\"></script>\n</head>\n<body>\n  <div id=\"unnamed-chunk-36-altair-viz\"></div>\n  <script>\n    (function(vegaEmbed) {\n      var spec = {\"config\": {\"view\": {\"continuousWidth\": 300, \"continuousHeight\": 300}}, \"layer\": [{\"data\": {\"name\": \"data-01e5db41e668cd375c2226c9c826f7bf\"}, \"mark\": {\"type\": \"circle\", \"size\": 50}, \"encoding\": {\"color\": {\"field\": \"variable\", \"type\": \"nominal\"}, \"tooltip\": [{\"field\": \"variable\", \"type\": \"nominal\"}, {\"field\": \"value\", \"type\": \"nominal\"}, {\"field\": \"component 0\", \"type\": \"quantitative\"}, {\"field\": \"component 1\", \"type\": \"quantitative\"}], \"x\": {\"axis\": {\"title\": \"component 0 \\u2014 79.39%\"}, \"field\": \"component 0\", \"scale\": {\"zero\": false}, \"type\": \"quantitative\"}, \"y\": {\"axis\": {\"title\": \"component 1 \\u2014 16.74%\"}, \"field\": \"component 1\", \"scale\": {\"zero\": false}, \"type\": \"quantitative\"}}, \"name\": \"view_1\"}, {\"data\": {\"name\": \"data-01e5db41e668cd375c2226c9c826f7bf\"}, \"mark\": {\"type\": \"text\"}, \"encoding\": {\"text\": {\"field\": \"label\", \"type\": \"nominal\"}, \"x\": {\"axis\": {\"title\": \"component 0 \\u2014 79.39%\"}, \"field\": \"component 0\", \"scale\": {\"zero\": false}, \"type\": \"quantitative\"}, \"y\": {\"axis\": {\"title\": \"component 1 \\u2014 16.74%\"}, \"field\": \"component 1\", \"scale\": {\"zero\": false}, \"type\": \"quantitative\"}}}, {\"data\": {\"name\": \"data-6712cfd530618eb8959a47ea48e1d9a9\"}, \"mark\": {\"type\": \"circle\", \"size\": 50}, \"encoding\": {\"color\": {\"field\": \"variable\", \"type\": \"nominal\"}, \"tooltip\": [{\"field\": \"variable\", \"type\": \"nominal\"}, {\"field\": \"value\", \"type\": \"nominal\"}, {\"field\": \"component 0\", \"type\": \"quantitative\"}, {\"field\": \"component 1\", \"type\": \"quantitative\"}], \"x\": {\"axis\": {\"title\": \"component 0 \\u2014 79.39%\"}, \"field\": \"component 0\", \"scale\": {\"zero\": false}, \"type\": \"quantitative\"}, \"y\": {\"axis\": {\"title\": \"component 1 \\u2014 16.74%\"}, \"field\": \"component 1\", \"scale\": {\"zero\": false}, \"type\": \"quantitative\"}}}, {\"data\": {\"name\": \"data-6712cfd530618eb8959a47ea48e1d9a9\"}, \"mark\": {\"type\": \"text\"}, \"encoding\": {\"text\": {\"field\": \"label\", \"type\": \"nominal\"}, \"x\": {\"axis\": {\"title\": \"component 0 \\u2014 79.39%\"}, \"field\": \"component 0\", \"scale\": {\"zero\": false}, \"type\": \"quantitative\"}, \"y\": {\"axis\": {\"title\": \"component 1 \\u2014 16.74%\"}, \"field\": \"component 1\", \"scale\": {\"zero\": false}, \"type\": \"quantitative\"}}}], \"params\": [{\"name\": \"param_1\", \"select\": {\"type\": \"interval\", \"encodings\": [\"x\", \"y\"]}, \"bind\": \"scales\", \"views\": [\"view_1\"]}], \"$schema\": \"https://vega.github.io/schema/vega-lite/v5.20.1.json\", \"datasets\": {\"data-01e5db41e668cd375c2226c9c826f7bf\": [{\"component 0\": -0.27965741381380965, \"component 1\": 0.24844319788592797, \"component 2\": 0.001244026153288674, \"component 3\": -0.012290741267969836, \"component 4\": -0.0022155254387415816, \"variable\": \"row\", \"value\": \"EAG\", \"label\": \"EAG\"}, {\"component 0\": -0.36246069125826536, \"component 1\": -0.016573724386627395, \"component 2\": -0.02625392302581359, \"component 3\": 0.009030059075840062, \"component 4\": 0.10463951889623065, \"variable\": \"row\", \"value\": \"SAG\", \"label\": \"SAG\"}, {\"component 0\": -0.025571954884564596, \"component 1\": 0.03621749767958715, \"component 2\": -0.06026422064563058, \"component 3\": 0.02435994748354897, \"component 4\": -0.0013035308375013831, \"variable\": \"row\", \"value\": \"PT\", \"label\": \"PT\"}, {\"component 0\": 0.22309291696042893, \"component 1\": 0.017213743147732583, \"component 2\": 0.0013554698476336412, \"component 3\": -0.004784734933268227, \"component 4\": 0.00085429097958194, \"variable\": \"row\", \"value\": \"PLCS\", \"label\": \"PLCS\"}, {\"component 0\": -0.09168245837423569, \"component 1\": -0.004397800704960146, \"component 2\": 0.057439310116524846, \"component 3\": 0.01065286674959633, \"component 4\": -0.003302803193411303, \"variable\": \"row\", \"value\": \"CM\", \"label\": \"CM\"}, {\"component 0\": -0.14789547245077145, \"component 1\": -0.022506467176876967, \"component 2\": 0.002262547973118471, \"component 3\": -0.0112209161954716, \"component 4\": 0.009098547221879229, \"variable\": \"row\", \"value\": \"EMP\", \"label\": \"EMP\"}, {\"component 0\": -0.3399742839222713, \"component 1\": 0.0030302027071938712, \"component 2\": -0.11697160597155504, \"component 3\": -0.05708383740836535, \"component 4\": -0.025513448180048946, \"variable\": \"row\", \"value\": \"OUV\", \"label\": \"OUV\"}, {\"component 0\": -0.11151128339348006, \"component 1\": -0.10742777914732411, \"component 2\": -0.013019763809452007, \"component 3\": -0.0040713613864079914, \"component 4\": -0.0026853461366855417, \"variable\": \"row\", \"value\": \"AUT\", \"label\": \"AUT\"}], \"data-6712cfd530618eb8959a47ea48e1d9a9\": [{\"component 0\": -0.02673760240437068, \"component 1\": -0.027387382929618957, \"component 2\": -0.030934403646360503, \"component 3\": -0.02018903479119096, \"component 4\": -0.004685904724920601, \"variable\": \"column\", \"value\": \"DR\", \"label\": \"DR\"}, {\"component 0\": -0.017333562047190332, \"component 1\": 0.020748374024023523, \"component 2\": -0.030772619492444808, \"component 3\": 0.017673953082685608, \"component 4\": -0.025579500671684574, \"variable\": \"column\", \"value\": \"SCE\", \"label\": \"SCE\"}, {\"component 0\": -0.07947263568698565, \"component 1\": -0.08148734535376438, \"component 2\": -0.0029005590897171465, \"component 3\": 0.0075419380757931614, \"component 4\": 0.0054152118075537405, \"variable\": \"column\", \"value\": \"LET\", \"label\": \"LET\"}, {\"component 0\": -0.08691834500642151, \"component 1\": 0.05583873155607015, \"component 2\": 0.07267256915779462, \"component 3\": -0.0033128087860211327, \"component 4\": -0.00323818360152697, \"variable\": \"column\", \"value\": \"SC\", \"label\": \"SC\"}, {\"component 0\": 0.2753881960672046, \"component 1\": 0.014300807935331866, \"component 2\": 0.0034269458799172214, \"component 3\": -0.003940079816089402, \"component 4\": 0.002594415731802649, \"variable\": \"column\", \"value\": \"MD\", \"label\": \"MD\"}, {\"component 0\": 0.17717047455070023, \"component 1\": 0.19108476639478955, \"component 2\": -0.04037475716112288, \"component 3\": 0.0268655926310026, \"component 4\": 0.007875443727969651, \"variable\": \"column\", \"value\": \"PH\", \"label\": \"PH\"}, {\"component 0\": -0.18254875122791467, \"component 1\": -0.061721908383680274, \"component 2\": 0.01897549461747648, \"component 3\": 0.02013079733003159, \"component 4\": -0.006501273909492338, \"variable\": \"column\", \"value\": \"PD\", \"label\": \"PD\"}, {\"component 0\": -0.4014010347307618, \"component 1\": 0.19319338970873115, \"component 2\": -0.043149233588869663, \"component 3\": -0.008594449179616645, \"component 4\": 0.009721395747527402, \"variable\": \"column\", \"value\": \"IUT\", \"label\": \"IUT\"}]}};\n      var embedOpt = {\"mode\": \"vega-lite\"};\n\n      function showError(el, error){\n          el.innerHTML = ('<div style=\"color:red;\">'\n                          + '<p>JavaScript Error: ' + error.message + '</p>'\n                          + \"<p>This usually means there's a typo in your chart specification. \"\n                          + \"See the javascript console for the full traceback.</p>\"\n                          + '</div>');\n          throw error;\n      }\n      const el = document.getElementById('unnamed-chunk-36-altair-viz');\n      vegaEmbed(\"#unnamed-chunk-36-altair-viz\", spec, embedOpt)\n        .catch(error => showError(el, error));\n    })(vegaEmbed);\n\n  </script>\n</body>\n</html>\n```\n:::\n:::\n\n::: {.cell}\n\n```{.python .cell-code}\nca.row_contributions_.head().style.format(precision=2)\n```\n\n::: {.cell-output-display}\n```{=html}\n<style type=\"text/css\">\n</style>\n<table id=\"T_a2713\">\n  <thead>\n    <tr>\n      <th class=\"blank level0\" >&nbsp;</th>\n      <th id=\"T_a2713_level0_col0\" class=\"col_heading level0 col0\" >0</th>\n      <th id=\"T_a2713_level0_col1\" class=\"col_heading level0 col1\" >1</th>\n      <th id=\"T_a2713_level0_col2\" class=\"col_heading level0 col2\" >2</th>\n      <th id=\"T_a2713_level0_col3\" class=\"col_heading level0 col3\" >3</th>\n      <th id=\"T_a2713_level0_col4\" class=\"col_heading level0 col4\" >4</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th id=\"T_a2713_level0_row0\" class=\"row_heading level0 row0\" >EAG</th>\n      <td id=\"T_a2713_row0_col0\" class=\"data row0 col0\" >0.15</td>\n      <td id=\"T_a2713_row0_col1\" class=\"data row0 col1\" >0.58</td>\n      <td id=\"T_a2713_row0_col2\" class=\"data row0 col2\" >0.00</td>\n      <td id=\"T_a2713_row0_col3\" class=\"data row0 col3\" >0.06</td>\n      <td id=\"T_a2713_row0_col4\" class=\"data row0 col4\" >0.00</td>\n    </tr>\n    <tr>\n      <th id=\"T_a2713_level0_row1\" class=\"row_heading level0 row1\" >SAG</th>\n      <td id=\"T_a2713_row1_col0\" class=\"data row1 col0\" >0.02</td>\n      <td id=\"T_a2713_row1_col1\" class=\"data row1 col1\" >0.00</td>\n      <td id=\"T_a2713_row1_col2\" class=\"data row1 col2\" >0.00</td>\n      <td id=\"T_a2713_row1_col3\" class=\"data row1 col3\" >0.00</td>\n      <td id=\"T_a2713_row1_col4\" class=\"data row1 col4\" >0.73</td>\n    </tr>\n    <tr>\n      <th id=\"T_a2713_level0_row2\" class=\"row_heading level0 row2\" >PT</th>\n      <td id=\"T_a2713_row2_col0\" class=\"data row2 col0\" >0.00</td>\n      <td id=\"T_a2713_row2_col1\" class=\"data row2 col1\" >0.02</td>\n      <td id=\"T_a2713_row2_col2\" class=\"data row2 col2\" >0.36</td>\n      <td id=\"T_a2713_row2_col3\" class=\"data row2 col3\" >0.46</td>\n      <td id=\"T_a2713_row2_col4\" class=\"data row2 col4\" >0.00</td>\n    </tr>\n    <tr>\n      <th id=\"T_a2713_level0_row3\" class=\"row_heading level0 row3\" >PLCS</th>\n      <td id=\"T_a2713_row3_col0\" class=\"data row3 col0\" >0.58</td>\n      <td id=\"T_a2713_row3_col1\" class=\"data row3 col1\" >0.02</td>\n      <td id=\"T_a2713_row3_col2\" class=\"data row3 col2\" >0.00</td>\n      <td id=\"T_a2713_row3_col3\" class=\"data row3 col3\" >0.05</td>\n      <td id=\"T_a2713_row3_col4\" class=\"data row3 col4\" >0.00</td>\n    </tr>\n    <tr>\n      <th id=\"T_a2713_level0_row4\" class=\"row_heading level0 row4\" >CM</th>\n      <td id=\"T_a2713_row4_col0\" class=\"data row4 col0\" >0.05</td>\n      <td id=\"T_a2713_row4_col1\" class=\"data row4 col1\" >0.00</td>\n      <td id=\"T_a2713_row4_col2\" class=\"data row4 col2\" >0.50</td>\n      <td id=\"T_a2713_row4_col3\" class=\"data row4 col3\" >0.13</td>\n      <td id=\"T_a2713_row4_col4\" class=\"data row4 col4\" >0.03</td>\n    </tr>\n  </tbody>\n</table>\n```\n:::\n\n```{.python .cell-code}\nca.column_contributions_.head().style.format(precision=2)\n```\n\n::: {.cell-output-display}\n```{=html}\n<style type=\"text/css\">\n</style>\n<table id=\"T_5698d\">\n  <thead>\n    <tr>\n      <th class=\"blank level0\" >&nbsp;</th>\n      <th id=\"T_5698d_level0_col0\" class=\"col_heading level0 col0\" >0</th>\n      <th id=\"T_5698d_level0_col1\" class=\"col_heading level0 col1\" >1</th>\n      <th id=\"T_5698d_level0_col2\" class=\"col_heading level0 col2\" >2</th>\n      <th id=\"T_5698d_level0_col3\" class=\"col_heading level0 col3\" >3</th>\n      <th id=\"T_5698d_level0_col4\" class=\"col_heading level0 col4\" >4</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th id=\"T_5698d_level0_row0\" class=\"row_heading level0 row0\" >DR</th>\n      <td id=\"T_5698d_row0_col0\" class=\"data row0 col0\" >0.00</td>\n      <td id=\"T_5698d_row0_col1\" class=\"data row0 col1\" >0.02</td>\n      <td id=\"T_5698d_row0_col2\" class=\"data row0 col2\" >0.13</td>\n      <td id=\"T_5698d_row0_col3\" class=\"data row0 col3\" >0.43</td>\n      <td id=\"T_5698d_row0_col4\" class=\"data row0 col4\" >0.05</td>\n    </tr>\n    <tr>\n      <th id=\"T_5698d_level0_row1\" class=\"row_heading level0 row1\" >SCE</th>\n      <td id=\"T_5698d_row1_col0\" class=\"data row1 col0\" >0.00</td>\n      <td id=\"T_5698d_row1_col1\" class=\"data row1 col1\" >0.00</td>\n      <td id=\"T_5698d_row1_col2\" class=\"data row1 col2\" >0.05</td>\n      <td id=\"T_5698d_row1_col3\" class=\"data row1 col3\" >0.13</td>\n      <td id=\"T_5698d_row1_col4\" class=\"data row1 col4\" >0.64</td>\n    </tr>\n    <tr>\n      <th id=\"T_5698d_level0_row2\" class=\"row_heading level0 row2\" >LET</th>\n      <td id=\"T_5698d_row2_col0\" class=\"data row2 col0\" >0.07</td>\n      <td id=\"T_5698d_row2_col1\" class=\"data row2 col1\" >0.33</td>\n      <td id=\"T_5698d_row2_col2\" class=\"data row2 col2\" >0.00</td>\n      <td id=\"T_5698d_row2_col3\" class=\"data row2 col3\" >0.11</td>\n      <td id=\"T_5698d_row2_col4\" class=\"data row2 col4\" >0.13</td>\n    </tr>\n    <tr>\n      <th id=\"T_5698d_level0_row3\" class=\"row_heading level0 row3\" >SC</th>\n      <td id=\"T_5698d_row3_col0\" class=\"data row3 col0\" >0.04</td>\n      <td id=\"T_5698d_row3_col1\" class=\"data row3 col1\" >0.07</td>\n      <td id=\"T_5698d_row3_col2\" class=\"data row3 col2\" >0.66</td>\n      <td id=\"T_5698d_row3_col3\" class=\"data row3 col3\" >0.01</td>\n      <td id=\"T_5698d_row3_col4\" class=\"data row3 col4\" >0.02</td>\n    </tr>\n    <tr>\n      <th id=\"T_5698d_level0_row4\" class=\"row_heading level0 row4\" >MD</th>\n      <td id=\"T_5698d_row4_col0\" class=\"data row4 col0\" >0.55</td>\n      <td id=\"T_5698d_row4_col1\" class=\"data row4 col1\" >0.01</td>\n      <td id=\"T_5698d_row4_col2\" class=\"data row4 col2\" >0.00</td>\n      <td id=\"T_5698d_row4_col3\" class=\"data row4 col3\" >0.02</td>\n      <td id=\"T_5698d_row4_col4\" class=\"data row4 col4\" >0.02</td>\n    </tr>\n  </tbody>\n</table>\n```\n:::\n:::\n\n\n# Données des tâches domestiques\n\nDans cette partie, nous étudions des données répertoriant la répartition des tâches domestiques au sein d'un couple. Cet ensemble de données est disponible dans la librairie R `factoextra`.  \n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata(\"housetasks\")\nknitr::kable(housetasks,align='c')\n```\n\n::: {.cell-output-display}\n|           | Wife | Alternating | Husband | Jointly |\n|:----------|:----:|:-----------:|:-------:|:-------:|\n|Laundry    | 156  |     14      |    2    |    4    |\n|Main_meal  | 124  |     20      |    5    |    4    |\n|Dinner     |  77  |     11      |    7    |   13    |\n|Breakfeast |  82  |     36      |   15    |    7    |\n|Tidying    |  53  |     11      |    1    |   57    |\n|Dishes     |  32  |     24      |    4    |   53    |\n|Shopping   |  33  |     23      |    9    |   55    |\n|Official   |  12  |     46      |   23    |   15    |\n|Driving    |  10  |     51      |   75    |    3    |\n|Finances   |  13  |     13      |   21    |   66    |\n|Insurance  |  8   |      1      |   53    |   77    |\n|Repairs    |  0   |      3      |   160   |    2    |\n|Holidays   |  0   |      1      |    6    |   153   |\n:::\n:::\n\n\nLes données sont un tableau de contingence contenant $13$ tâches domestiques et leur répartition dans le couple. \nLes lignes sont les différentes tâches, les valeurs sont les fréquences des tâches effectuées :\n\n  - par la femme uniquement,\n  - alternativement,\n  - par le mari uniquement,\n  - ou conjointement.\n\nLes données de cet exemple traitent de l'intégration des femmes mariées sur le marché du travail en 1977. On a demandé à des couples bi-salariés, nouvellement mariés et sans enfant de cinq villes allemandes qui était responsable de chacune des tâches suivantes:\n\n- s'occuper du linge, \n- préparer les repas principaux, \n- préparer le dîner, \n- préparer le petit déjeuner, \n- ranger la maison, \n- faire la vaisselle, \n- faire les courses, \n- s'occuper des démarches officielles (déclarations d'impôts, etc.), \n- conduire une voiture, \n- s'occuper des finances, \n- s'occuper des assurances, \n- faire les petites réparations ménagères, \n- planifier les voyages et les vacances.\n\n**Question :** Après avoir visualisé cette table de contingence et testé l'indépendance des deux variables qualitatives, faites une analyse des correspondances. Interprétez.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# A COMPLETER\n```\n:::\n\n\n:::{.callout-note custom-style=\"correction\" appearance=\"simple\" title=\"Correction\"}\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ggpubr)\nggballoonplot(housetasks, fill = \"value\")+\n     scale_fill_viridis_c(option = \"C\")\n```\n\n::: {.cell-output-display}\n![](2526-TP2-CA-Correction_files/figure-html/unnamed-chunk-40-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nchisq.test(housetasks)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tPearson's Chi-squared test\n\ndata:  housetasks\nX-squared = 1944.5, df = 36, p-value < 2.2e-16\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nres.ca = CA(housetasks, graph=FALSE)\nprint(res.ca)  \n```\n\n::: {.cell-output .cell-output-stdout}\n```\n**Results of the Correspondence Analysis (CA)**\nThe row variable has  13  categories; the column variable has 4 categories\nThe chi square of independence between the two variables is equal to 1944.456 (p-value =  0 ).\n*The results are available in the following objects:\n\n   name              description                   \n1  \"$eig\"            \"eigenvalues\"                 \n2  \"$col\"            \"results for the columns\"     \n3  \"$col$coord\"      \"coord. for the columns\"      \n4  \"$col$cos2\"       \"cos2 for the columns\"        \n5  \"$col$contrib\"    \"contributions of the columns\"\n6  \"$row\"            \"results for the rows\"        \n7  \"$row$coord\"      \"coord. for the rows\"         \n8  \"$row$cos2\"       \"cos2 for the rows\"           \n9  \"$row$contrib\"    \"contributions of the rows\"   \n10 \"$call\"           \"summary called parameters\"   \n11 \"$call$marge.col\" \"weights of the columns\"      \n12 \"$call$marge.row\" \"weights of the rows\"         \n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nfviz_eig(res.ca)\n```\n\n::: {.cell-output-display}\n![](2526-TP2-CA-Correction_files/figure-html/unnamed-chunk-43-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nfviz_ca(res.ca, repel=TRUE)\n```\n\n::: {.cell-output-display}\n![](2526-TP2-CA-Correction_files/figure-html/unnamed-chunk-44-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nfviz_cos2(res.ca,choice=c(\"row\"))\n```\n\n::: {.cell-output-display}\n![](2526-TP2-CA-Correction_files/figure-html/unnamed-chunk-45-1.png){width=672}\n:::\n\n```{.r .cell-code}\nfviz_ca_row(res.ca, col.row = \"cos2\",\n             gradient.cols = c(\"blue\", \"yellow\", \"red\"), \n             repel = TRUE)\n```\n\n::: {.cell-output-display}\n![](2526-TP2-CA-Correction_files/figure-html/unnamed-chunk-45-2.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nfviz_cos2(res.ca,choice=c(\"col\"))\n```\n\n::: {.cell-output-display}\n![](2526-TP2-CA-Correction_files/figure-html/unnamed-chunk-46-1.png){width=672}\n:::\n\n```{.r .cell-code}\nfviz_ca_col(res.ca, col.col = \"cos2\",\n             gradient.cols = c(\"blue\", \"yellow\", \"red\"), \n             repel = TRUE)\n```\n\n::: {.cell-output-display}\n![](2526-TP2-CA-Correction_files/figure-html/unnamed-chunk-46-2.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nfviz_contrib(res.ca,choice=\"row\")\n```\n\n::: {.cell-output-display}\n![](2526-TP2-CA-Correction_files/figure-html/unnamed-chunk-47-1.png){width=672}\n:::\n\n```{.r .cell-code}\nfviz_ca_row(res.ca, col.row = \"contrib\",\n             gradient.cols = c(\"blue\", \"yellow\", \"red\"), \n             repel = TRUE)\n```\n\n::: {.cell-output-display}\n![](2526-TP2-CA-Correction_files/figure-html/unnamed-chunk-47-2.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nfviz_contrib(res.ca,choice=\"col\")\n```\n\n::: {.cell-output-display}\n![](2526-TP2-CA-Correction_files/figure-html/unnamed-chunk-48-1.png){width=672}\n:::\n\n```{.r .cell-code}\nfviz_ca_row(res.ca, col.col = \"contrib\",\n             gradient.cols = c(\"blue\", \"yellow\", \"red\"), \n             repel = TRUE)\n```\n\n::: {.cell-output-display}\n![](2526-TP2-CA-Correction_files/figure-html/unnamed-chunk-48-2.png){width=672}\n:::\n:::\n\n\n:::\n\n\n",
    "supporting": [
      "2526-TP2-CA-Correction_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}