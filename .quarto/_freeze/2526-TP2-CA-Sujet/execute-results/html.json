{
  "hash": "f3a44774494462f3a00674d153401d70",
  "result": {
    "markdown": "---\ntitle: \"TP2 - Correspondence Analysis\"\nformat:\n  html:\n    toc: true\n    toc-depth : 4\n    toc-location: left\n    number-sections: true\n    css: styles.css\n    header-includes:\n    - \\usepackage{dsfont}\n---\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ggplot2)\nlibrary(FactoMineR)\nlibrary(factoextra)\nlibrary(reticulate)\nlibrary(ggpubr)\n```\n:::\n\n\n# Données de sociologie\n\n## Description\n\nNous nous intéressons dans ce TP à des données issues du travail du sociologue Pierre Bourdieu.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nSocio<-read.table(\"DataSocio.txt\",header=T)\n```\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n|     | DR  | SCE | LET | SC  | MD  | PH  | PD | IUT |\n|:----|:---:|:---:|:---:|:---:|:---:|:---:|:--:|:---:|\n|EAG  | 80  | 36  | 134 | 99  | 65  | 28  | 11 | 58  |\n|SAG  |  6  |  2  | 15  |  6  |  4  |  1  | 1  |  4  |\n|PT   | 168 | 74  | 312 | 137 | 208 | 53  | 21 | 62  |\n|PLCS | 470 | 191 | 806 | 400 | 876 | 164 | 45 | 79  |\n|CM   | 236 | 99  | 493 | 264 | 281 | 56  | 36 | 87  |\n|EMP  | 145 | 52  | 281 | 133 | 135 | 30  | 20 | 54  |\n|OUV  | 16  |  6  | 27  | 11  |  8  |  2  | 2  |  8  |\n|AUT  | 305 | 115 | 624 | 247 | 301 | 47  | 42 | 90  |\n:::\n:::\n\n\nLa table de contingence `Socio` contient les effectifs des étudiants de l'enquête.\n\n::: columns\n::: {.column width=\"45%\"}\nEn ligne, nous avons les différentes catégories socioprofessionnelles pour le chef de famille :\n\n-   EAG : exploitant agricole\n-   SAG : salarié agricole\n-   PT : patron\n-   PLCS : profession libérale et cadre supérieur\n-   CM : cadre moyen\n-   EMP : employé\n-   OUV : ouvrier\n-   AUT : autre\n:::\n\n::: {.column width=\"45%\"}\nEn colonne, nous retrouvons les types d'études poursuivies\n\n-   DR : droit\n-   SCE : sciences économiques\n-   LET : lettres\n-   SC : sciences\n-   MD : médecine ou dentaire\n-   PH : pharmacie\n-   PD : pluridisciplinaire\n-   IUT : IUT\n:::\n:::\n\nNous pouvons visualiser cette table de contingence à l'aide de la fonction `ggballoonplot()` de la librairie `ggpubr`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggballoonplot(Socio, fill = \"value\")+\n     scale_fill_viridis_c(option = \"C\")\n```\n\n::: {.cell-output-display}\n![](2526-TP2-CA-Sujet_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\n**Question :** A l'aide de la fonction `chisq.test()`, testez s'il y a indépendance ou pas entre les deux variables qualitatives.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# A COMPLETER\n```\n:::\n\n\n## Analyse des correspondances à la main\n\nAfin d'assimiler le cours, nous allons tout d'abord faire l'analyse des correspondances \"à la main\".\n\n**Question :** La première étape consiste à définir les matrices $F_X$ et $F_Y$ contenant les profils lignes et colonnes respectivement, associés à ces données. Construisez ces deux matrices à l'aide des fonctions `diag()`, `rowSums()`, `colSums()`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# A COMPLETER\nFX<- ...\nrownames(FX) <- rownames(Socio)\nFY<-  ...\nrownames(FY) <- colnames(Socio)\n```\n:::\n\n\n**Question :** Faites une ACP sur les profils lignes\n\n-   matrice des données $F_X$\n-   matrice des poids $W=W_X = \\mbox{diag}(n_{1+}/n,\\ldots,n_{I+}/n)$\n-   métrique associée à la matrice $M = W_Y^{-1}=\\mbox{diag}(n/n_{+1},\\ldots,n/n_{+J})$\n\nPour cela, déterminez les valeurs propres et vecteurs propres à l'aide de la fonction `eigen()` d'une matrice bien choisie.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# A COMPLETER\nACPX<-eigen(....)\n```\n:::\n\n\n**Question :** Vérifiez que l'ACP des profils-lignes peut se retrouver par la décomposition spectrale de $(F_YF_X)'$. Que remarque-t-on concernant les valeurs propres.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# A COMPLETER\n```\n:::\n\n\n**Question :** Déterminez les composantes principales $C^{(row)}_s$.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nCrow<-...\n```\n:::\n\n\n**Question :** Faites une ACP des profils-colonnes avec la matrice des poids $W=W_Y$ et la métrique associée à la matrice $M = W_X^{-1}$. Déterminez les composantes principales $C^{(col)}_s$.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# A COMPLETER\nACPY<-eigen(...)\nCcol<-....\n```\n:::\n\n\n**Question :** Quelle relation permet de relier $C^{(row)}_s$ et $C^{(col)}_s$ ? Vérifiez numériquement.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# A COMPLETER\n```\n:::\n\n\n## Analyse des correspondances avec FactoMineR\n\n**Question :** A l'aide de la fonction `CA()` de la librairie `FactoMineR`, faites une analyse des correspondances du jeu de données Socio. Retrouvez les pvaleurs, les composantes principales, .... par rapport aux calculs précédents.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nresCA<-CA(.....) # A COMPLETER\n```\n:::\n\n\n**Question :** Tracez les modalités sur le premier plan factoriel et interprétez.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfviz_ca(....) # A COMPLETER\n```\n:::\n\n\n**Question :** Etudiez la qualité de représentation de chaque catégorie socioprofessionnelle et de chaque type d'étude suivie. Commentez. Vous pouvez utiliser les fonctions `fviz_cos2()`, `fviz_ca_row()`et `fviz_ca_col()` pour la visualisation.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# A COMPLETER\n```\n:::\n\n\n**Question :** Etudiez les contributions de chaque catégorie socioprofessionnelle et de chaque type d'étude suivie pour le premier axe. Vous pouvez utiliser les fonctions `fviz_contrib()`, `fviz_ca_row()`et `fviz_ca_col()` pour la visualisation.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# A COMPLETER\n```\n:::\n\n\n## Analyse des correspondances avec Python\n\nDans cette partie, nous allons faire une analyse des correspondances à l'aide de la librairie `prince` en Python. Retrouvez les éléments vus précédemment à l'aide des commandes suivantes.\n\n\n::: {.cell}\n\n```{.python .cell-code}\nimport prince\n\nSociopy=r.Socio\nca = prince.CA(\n    n_components=5,\n    n_iter=3,\n    copy=True,\n    check_input=True,\n    engine='sklearn',\n    random_state=42\n)\nca = ca.fit(Sociopy)\n```\n:::\n\n::: {.cell}\n\n```{.python .cell-code}\nca.eigenvalues_summary\n```\n:::\n\n::: {.cell}\n\n```{.python .cell-code}\nca.row_coordinates(Sociopy).head()\nca.column_coordinates(Sociopy).head()\n```\n:::\n\n::: {.cell}\n\n```{.python .cell-code}\nca.plot(\n    Sociopy,\n    x_component=0,\n    y_component=1,\n    show_row_markers=True,\n    show_column_markers=True,\n    show_row_labels=True,\n    show_column_labels=True\n)\n```\n:::\n\n::: {.cell}\n\n```{.python .cell-code}\nca.row_contributions_.head().style.format(precision=2)\nca.column_contributions_.head().style.format(precision=2)\n```\n:::\n\n\n# Données des tâches domestiques\n\nDans cette partie, nous étudions des données répertoriant la répartition des tâches domestiques au sein d'un couple. Cet ensemble de données est disponible dans la librairie R `factoextra`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata(\"housetasks\")\nknitr::kable(housetasks,align='c')\n```\n\n::: {.cell-output-display}\n|           | Wife | Alternating | Husband | Jointly |\n|:----------|:----:|:-----------:|:-------:|:-------:|\n|Laundry    | 156  |     14      |    2    |    4    |\n|Main_meal  | 124  |     20      |    5    |    4    |\n|Dinner     |  77  |     11      |    7    |   13    |\n|Breakfeast |  82  |     36      |   15    |    7    |\n|Tidying    |  53  |     11      |    1    |   57    |\n|Dishes     |  32  |     24      |    4    |   53    |\n|Shopping   |  33  |     23      |    9    |   55    |\n|Official   |  12  |     46      |   23    |   15    |\n|Driving    |  10  |     51      |   75    |    3    |\n|Finances   |  13  |     13      |   21    |   66    |\n|Insurance  |  8   |      1      |   53    |   77    |\n|Repairs    |  0   |      3      |   160   |    2    |\n|Holidays   |  0   |      1      |    6    |   153   |\n:::\n:::\n\n\nLes données sont un tableau de contingence contenant $13$ tâches domestiques et leur répartition dans le couple. Les lignes sont les différentes tâches, les valeurs sont les fréquences des tâches effectuées :\n\n-   par la femme uniquement,\n-   alternativement,\n-   par le mari uniquement,\n-   ou conjointement.\n\nLes données de cet exemple traitent de l'intégration des femmes mariées sur le marché du travail en 1977. On a demandé à des couples bi-salariés, nouvellement mariés et sans enfant de cinq villes allemandes qui était responsable de chacune des tâches suivantes:\n\n-   s'occuper du linge,\n-   préparer les repas principaux,\n-   préparer le dîner,\n-   préparer le petit déjeuner,\n-   ranger la maison,\n-   faire la vaisselle,\n-   faire les courses,\n-   s'occuper des démarches officielles (déclarations d'impôts, etc.),\n-   conduire une voiture,\n-   s'occuper des finances,\n-   s'occuper des assurances,\n-   faire les petites réparations ménagères,\n-   planifier les voyages et les vacances.\n\n**Question :** Après avoir visualisé cette table de contingence et testé l'indépendance des deux variables qualitatives, faites une analyse des correspondances. Interprétez.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# A COMPLETER\n```\n:::\n",
    "supporting": [
      "2526-TP2-CA-Sujet_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}