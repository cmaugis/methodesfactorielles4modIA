{"title":"TP2 - Correspondence Analysis","markdown":{"yaml":{"title":"TP2 - Correspondence Analysis","subtitle":"4modIA / 2025-2026","format":{"html":{"toc":true,"toc-depth":4,"toc-location":"left","number-sections":true,"css":"styles.css","header-includes":["\\usepackage{dsfont}"]}}},"headingText":"Données de sociologie","containsRefs":false,"markdown":"\n\n```{r}\n#| warning: false\n#| message: false\n\nlibrary(ggplot2)\nlibrary(FactoMineR)\nlibrary(factoextra)\nlibrary(reticulate)\nlibrary(ggpubr)\n```\n\n\n\n## Description \n\nNous nous intéressons dans ce TP à des données issues du travail du sociologue Pierre Bourdieu. \n\n```{r}\nSocio<-read.table(\"DataSocio.txt\",header=T)\n```\n\n```{r}\n#| echo: false\nknitr::kable(Socio,align='c')\n```\n\nLa table de contingence `Socio` contient les effectifs des étudiants de l’enquête.\n\n::: columns\n::: {.column width=\"45%\"}\nEn ligne, nous avons les différentes catégories \nsocioprofessionnelles pour le chef de famille : \n\n- EAG : exploitant agricole\n- SAG : salarié agricole \n- PT : patron \n- PLCS : profession libérale et cadre supérieur \n- CM : cadre moyen\n- EMP : employé\n- OUV : ouvrier \n- AUT : autre\n:::\n::: {.column width=\"45%\"}\nEn colonne, nous retrouvons les types d'études poursuivies\n\n- DR : droit \n- SCE : sciences économiques \n- LET : lettres \n- SC : sciences \n- MD : médecine ou dentaire \n- PH : pharmacie \n- PD : pluridisciplinaire \n- IUT : IUT\n:::\n:::\n\nNous pouvons visualiser cette table de contingence à l'aide de la fonction `ggballoonplot()` de la librairie `ggpubr`.  \n\n```{r}\nggballoonplot(Socio, fill = \"value\")+\n     scale_fill_viridis_c(option = \"C\")\n```\n\n**Question :** A l'aide de la fonction `chisq.test()`, testez s'il y a indépendance ou pas entre les deux variables qualitatives. \n\n```{r}\n#| eval: false\n\n# A COMPLETER\n```\n\n## Analyse des correspondances à la main\n\nAfin d'assimiler le cours, nous allons tout d'abord faire l'analyse des correspondances \"à la main\". \n\n**Question :** La première étape consiste à définir les matrices $F_X$ et $F_Y$ contenant les profils lignes et colonnes respectivement, associés à ces données. Construisez ces deux matrices à l'aide des fonctions `diag()`, `rowSums()`, `colSums()`. \n\n```{r}\n#| eval: false\n\n# A COMPLETER\nFX<- ...\nrownames(FX) <- rownames(Socio)\nFY<-  ...\nrownames(FY) <- colnames(Socio)\n```\n\n\n**Question :** Faites une ACP sur les profils lignes\n\n+ matrice des données $F_X$ \n+ matrice des poids $W=W_X = \\mbox{diag}(n_{1+}/n,\\ldots,n_{I+}/n)$ \n+ métrique associée à la matrice \n$M = W_Y^{-1}=\\mbox{diag}(n/n_{+1},\\ldots,n/n_{+J})$\n\nPour cela, déterminez les valeurs propres et vecteurs propres à l'aide de la fonction `eigen()` d'une matrice bien choisie. \n\n```{r}\n#| eval: false \n\n# A COMPLETER\nACPX<-eigen(....)\n```\n\n\n\n**Question :** Vérifiez que l'ACP des profils-lignes peut se retrouver par la décomposition spectrale de $(F_YF_X)'$. Que remarque-t-on concernant les valeurs propres. \n\n```{r}\n#| eval: false\n# A COMPLETER\n```\n\n**Question :** Déterminez les composantes principales $C^{(row)}_s$.\n\n```{r}\n#| eval: false\nCrow<-...\n```\n\n**Question :** Faites une ACP des profils-colonnes avec la matrice des poids\n$W=W_Y$ et la métrique associée à la matrice $M = W_X^{-1}$. Déterminez les composantes principales $C^{(col)}_s$.\n\n```{r}\n#| eval: false\n\n# A COMPLETER\nACPY<-eigen(...)\nCcol<-....\n```\n\n\n**Question :** Quelle relation permet de relier $C^{(row)}_s$ et $C^{(col)}_s$ ? Vérifiez numériquement.\n\n```{r}\n#| eval: false\n\n# A COMPLETER\n```\n\n## Analyse des correspondances avec FactoMineR\n\n**Question :** A l'aide de la fonction `CA()` de la librairie `FactoMineR`, faites une analyse des correspondances du jeu de données Socio. Retrouvez les pvaleurs, les composantes principales, .... par rapport aux calculs précédents. \n\n```{r}\n#| eval: false\n\nresCA<-CA(.....) # A COMPLETER\n```\n\n\n**Question :** Tracez les modalités sur le premier plan factoriel et interprétez.\n\n```{r}\n#| eval: false\n\nfviz_ca(....) # A COMPLETER\n```\n\n**Question :** Etudiez la qualité de représentation de chaque catégorie socioprofessionnelle et de chaque type d'étude suivie.\nCommentez. Vous pouvez utiliser les fonctions `fviz_cos2()`, `fviz_ca_row()`et `fviz_ca_col()` pour la visualisation.  \n\n```{r}\n#| eval: false\n\n# A COMPLETER\n```\n\n\n**Question :** Etudiez les contributions de chaque catégorie socioprofessionnelle et de chaque type d'étude suivie pour le premier axe. Vous pouvez utiliser les fonctions `fviz_contrib()`, `fviz_ca_row()`et `fviz_ca_col()` pour la visualisation. \n\n```{r}\n#| eval: false\n\n# A COMPLETER\n```\n\n\n## Analyse des correspondances avec Python\n\nDans cette partie, nous allons faire une analyse des correspondances à l'aide de la librairie `prince` en Python. \nRetrouvez les éléments vus précédemment à l'aide des commandes suivantes. \n\n```{python}\n#| eval: False\n\nimport prince\n\nSociopy=r.Socio\nca = prince.CA(\n    n_components=5,\n    n_iter=3,\n    copy=True,\n    check_input=True,\n    engine='sklearn',\n    random_state=42\n)\nca = ca.fit(Sociopy)\n```\n\n```{python}\n#| eval: False\n\nca.eigenvalues_summary\n```\n\n```{python}\n#| eval: False\n\nca.row_coordinates(Sociopy).head()\nca.column_coordinates(Sociopy).head()\n```\n\n```{python}\n#| eval: False\n\nca.plot(\n    Sociopy,\n    x_component=0,\n    y_component=1,\n    show_row_markers=True,\n    show_column_markers=True,\n    show_row_labels=True,\n    show_column_labels=True\n)\n```\n\n```{python}\n#| eval: False\n\nca.row_contributions_.head().style.format(precision=2)\nca.column_contributions_.head().style.format(precision=2)\n```\n\n# Données des tâches domestiques\n\nDans cette partie, nous étudions des données répertoriant la répartition des tâches domestiques au sein d'un couple. Cet ensemble de données est disponible dans la librairie R `factoextra`.  \n\n```{r}\ndata(\"housetasks\")\nknitr::kable(housetasks,align='c')\n```\n\nLes données sont un tableau de contingence contenant $13$ tâches domestiques et leur répartition dans le couple. \nLes lignes sont les différentes tâches, les valeurs sont les fréquences des tâches effectuées :\n\n  - par la femme uniquement,\n  - alternativement,\n  - par le mari uniquement,\n  - ou conjointement.\n\nLes données de cet exemple traitent de l'intégration des femmes mariées sur le marché du travail en 1977. On a demandé à des couples bi-salariés, nouvellement mariés et sans enfant de cinq villes allemandes qui était responsable de chacune des tâches suivantes:\n\n- s'occuper du linge, \n- préparer les repas principaux, \n- préparer le dîner, \n- préparer le petit déjeuner, \n- ranger la maison, \n- faire la vaisselle, \n- faire les courses, \n- s'occuper des démarches officielles (déclarations d'impôts, etc.), \n- conduire une voiture, \n- s'occuper des finances, \n- s'occuper des assurances, \n- faire les petites réparations ménagères, \n- planifier les voyages et les vacances.\n\n**Question :** Après avoir visualisé cette table de contingence et testé l'indépendance des deux variables qualitatives, faites une analyse des correspondances. Interprétez.\n\n```{r}\n# A COMPLETER\n```\n\n","srcMarkdownNoYaml":"\n\n```{r}\n#| warning: false\n#| message: false\n\nlibrary(ggplot2)\nlibrary(FactoMineR)\nlibrary(factoextra)\nlibrary(reticulate)\nlibrary(ggpubr)\n```\n\n\n# Données de sociologie\n\n## Description \n\nNous nous intéressons dans ce TP à des données issues du travail du sociologue Pierre Bourdieu. \n\n```{r}\nSocio<-read.table(\"DataSocio.txt\",header=T)\n```\n\n```{r}\n#| echo: false\nknitr::kable(Socio,align='c')\n```\n\nLa table de contingence `Socio` contient les effectifs des étudiants de l’enquête.\n\n::: columns\n::: {.column width=\"45%\"}\nEn ligne, nous avons les différentes catégories \nsocioprofessionnelles pour le chef de famille : \n\n- EAG : exploitant agricole\n- SAG : salarié agricole \n- PT : patron \n- PLCS : profession libérale et cadre supérieur \n- CM : cadre moyen\n- EMP : employé\n- OUV : ouvrier \n- AUT : autre\n:::\n::: {.column width=\"45%\"}\nEn colonne, nous retrouvons les types d'études poursuivies\n\n- DR : droit \n- SCE : sciences économiques \n- LET : lettres \n- SC : sciences \n- MD : médecine ou dentaire \n- PH : pharmacie \n- PD : pluridisciplinaire \n- IUT : IUT\n:::\n:::\n\nNous pouvons visualiser cette table de contingence à l'aide de la fonction `ggballoonplot()` de la librairie `ggpubr`.  \n\n```{r}\nggballoonplot(Socio, fill = \"value\")+\n     scale_fill_viridis_c(option = \"C\")\n```\n\n**Question :** A l'aide de la fonction `chisq.test()`, testez s'il y a indépendance ou pas entre les deux variables qualitatives. \n\n```{r}\n#| eval: false\n\n# A COMPLETER\n```\n\n## Analyse des correspondances à la main\n\nAfin d'assimiler le cours, nous allons tout d'abord faire l'analyse des correspondances \"à la main\". \n\n**Question :** La première étape consiste à définir les matrices $F_X$ et $F_Y$ contenant les profils lignes et colonnes respectivement, associés à ces données. Construisez ces deux matrices à l'aide des fonctions `diag()`, `rowSums()`, `colSums()`. \n\n```{r}\n#| eval: false\n\n# A COMPLETER\nFX<- ...\nrownames(FX) <- rownames(Socio)\nFY<-  ...\nrownames(FY) <- colnames(Socio)\n```\n\n\n**Question :** Faites une ACP sur les profils lignes\n\n+ matrice des données $F_X$ \n+ matrice des poids $W=W_X = \\mbox{diag}(n_{1+}/n,\\ldots,n_{I+}/n)$ \n+ métrique associée à la matrice \n$M = W_Y^{-1}=\\mbox{diag}(n/n_{+1},\\ldots,n/n_{+J})$\n\nPour cela, déterminez les valeurs propres et vecteurs propres à l'aide de la fonction `eigen()` d'une matrice bien choisie. \n\n```{r}\n#| eval: false \n\n# A COMPLETER\nACPX<-eigen(....)\n```\n\n\n\n**Question :** Vérifiez que l'ACP des profils-lignes peut se retrouver par la décomposition spectrale de $(F_YF_X)'$. Que remarque-t-on concernant les valeurs propres. \n\n```{r}\n#| eval: false\n# A COMPLETER\n```\n\n**Question :** Déterminez les composantes principales $C^{(row)}_s$.\n\n```{r}\n#| eval: false\nCrow<-...\n```\n\n**Question :** Faites une ACP des profils-colonnes avec la matrice des poids\n$W=W_Y$ et la métrique associée à la matrice $M = W_X^{-1}$. Déterminez les composantes principales $C^{(col)}_s$.\n\n```{r}\n#| eval: false\n\n# A COMPLETER\nACPY<-eigen(...)\nCcol<-....\n```\n\n\n**Question :** Quelle relation permet de relier $C^{(row)}_s$ et $C^{(col)}_s$ ? Vérifiez numériquement.\n\n```{r}\n#| eval: false\n\n# A COMPLETER\n```\n\n## Analyse des correspondances avec FactoMineR\n\n**Question :** A l'aide de la fonction `CA()` de la librairie `FactoMineR`, faites une analyse des correspondances du jeu de données Socio. Retrouvez les pvaleurs, les composantes principales, .... par rapport aux calculs précédents. \n\n```{r}\n#| eval: false\n\nresCA<-CA(.....) # A COMPLETER\n```\n\n\n**Question :** Tracez les modalités sur le premier plan factoriel et interprétez.\n\n```{r}\n#| eval: false\n\nfviz_ca(....) # A COMPLETER\n```\n\n**Question :** Etudiez la qualité de représentation de chaque catégorie socioprofessionnelle et de chaque type d'étude suivie.\nCommentez. Vous pouvez utiliser les fonctions `fviz_cos2()`, `fviz_ca_row()`et `fviz_ca_col()` pour la visualisation.  \n\n```{r}\n#| eval: false\n\n# A COMPLETER\n```\n\n\n**Question :** Etudiez les contributions de chaque catégorie socioprofessionnelle et de chaque type d'étude suivie pour le premier axe. Vous pouvez utiliser les fonctions `fviz_contrib()`, `fviz_ca_row()`et `fviz_ca_col()` pour la visualisation. \n\n```{r}\n#| eval: false\n\n# A COMPLETER\n```\n\n\n## Analyse des correspondances avec Python\n\nDans cette partie, nous allons faire une analyse des correspondances à l'aide de la librairie `prince` en Python. \nRetrouvez les éléments vus précédemment à l'aide des commandes suivantes. \n\n```{python}\n#| eval: False\n\nimport prince\n\nSociopy=r.Socio\nca = prince.CA(\n    n_components=5,\n    n_iter=3,\n    copy=True,\n    check_input=True,\n    engine='sklearn',\n    random_state=42\n)\nca = ca.fit(Sociopy)\n```\n\n```{python}\n#| eval: False\n\nca.eigenvalues_summary\n```\n\n```{python}\n#| eval: False\n\nca.row_coordinates(Sociopy).head()\nca.column_coordinates(Sociopy).head()\n```\n\n```{python}\n#| eval: False\n\nca.plot(\n    Sociopy,\n    x_component=0,\n    y_component=1,\n    show_row_markers=True,\n    show_column_markers=True,\n    show_row_labels=True,\n    show_column_labels=True\n)\n```\n\n```{python}\n#| eval: False\n\nca.row_contributions_.head().style.format(precision=2)\nca.column_contributions_.head().style.format(precision=2)\n```\n\n# Données des tâches domestiques\n\nDans cette partie, nous étudions des données répertoriant la répartition des tâches domestiques au sein d'un couple. Cet ensemble de données est disponible dans la librairie R `factoextra`.  \n\n```{r}\ndata(\"housetasks\")\nknitr::kable(housetasks,align='c')\n```\n\nLes données sont un tableau de contingence contenant $13$ tâches domestiques et leur répartition dans le couple. \nLes lignes sont les différentes tâches, les valeurs sont les fréquences des tâches effectuées :\n\n  - par la femme uniquement,\n  - alternativement,\n  - par le mari uniquement,\n  - ou conjointement.\n\nLes données de cet exemple traitent de l'intégration des femmes mariées sur le marché du travail en 1977. On a demandé à des couples bi-salariés, nouvellement mariés et sans enfant de cinq villes allemandes qui était responsable de chacune des tâches suivantes:\n\n- s'occuper du linge, \n- préparer les repas principaux, \n- préparer le dîner, \n- préparer le petit déjeuner, \n- ranger la maison, \n- faire la vaisselle, \n- faire les courses, \n- s'occuper des démarches officielles (déclarations d'impôts, etc.), \n- conduire une voiture, \n- s'occuper des finances, \n- s'occuper des assurances, \n- faire les petites réparations ménagères, \n- planifier les voyages et les vacances.\n\n**Question :** Après avoir visualisé cette table de contingence et testé l'indépendance des deux variables qualitatives, faites une analyse des correspondances. Interprétez.\n\n```{r}\n# A COMPLETER\n```\n\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"knitr"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true,"format-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["styles.css"],"toc":true,"toc-depth":4,"number-sections":true,"output-file":"2526-TP2-CA-Sujet.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.3.433","editor":"visual","theme":"cosmo","title":"TP2 - Correspondence Analysis","subtitle":"4modIA / 2025-2026","toc-location":"left","header-includes":["\\usepackage{dsfont}"]},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}